[
["index.html", "Minería de datos con R EST-384 Prefacio Audiencia Estructura del libro Software y acuerdos Datos Agradecimiento", " Minería de datos con R EST-384 Alvaro Chirino Gutierrez 2020-06-25 Prefacio Este documento de Alvaro Chirino esta bajo la licencia de Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. Audiencia El libro fue diseñado originalmente para los estudiantes de la materia de Programación Estadística II, una materia optativa del pregrado de la carrera de Estadística de la Universidad Mayor de San Andrés. Este documento representa un primer acercamiento a los estudiantes de estadistica al software R y al mundo de la minería de datos. Estructura del libro El libro inluye 5 capitulos, estos son: Introducción a R Preparación de los datos Modelado en Minería de datos Minería de Texto Machine Learning Software y acuerdos sessionInfo() ## R version 4.0.2 (2020-06-22) ## Platform: x86_64-w64-mingw32/x64 (64-bit) ## Running under: Windows 10 x64 (build 18363) ## ## Matrix products: default ## ## locale: ## [1] LC_COLLATE=Spanish_Bolivia.1252 ## [2] LC_CTYPE=Spanish_Bolivia.1252 ## [3] LC_MONETARY=Spanish_Bolivia.1252 ## [4] LC_NUMERIC=C ## [5] LC_TIME=Spanish_Bolivia.1252 ## ## attached base packages: ## [1] stats graphics grDevices utils datasets ## [6] methods base ## ## loaded via a namespace (and not attached): ## [1] compiler_4.0.2 magrittr_1.5 bookdown_0.18 ## [4] htmltools_0.4.0 tools_4.0.2 rstudioapi_0.11 ## [7] yaml_2.2.1 Rcpp_1.0.4.6 stringi_1.4.6 ## [10] rmarkdown_2.3 knitr_1.28 stringr_1.4.0 ## [13] xfun_0.13 digest_0.6.25 packrat_0.5.0 ## [16] rlang_0.4.6 evaluate_0.14 Datos Agradecimiento Peeta… "],
["acerca-del-autor.html", "Acerca del autor Bibliografía", " Acerca del autor Bibliografía Torgo, L. (2016). Data mining with R: Learning with case studies, second edition. Hernandez, J. (2004). Introducción a la Minería de Datos Step, I., &amp; Blueprint, S. (2017). MACHINE LEARNING Intuitive Step by Step. "],
["minería-de-datos.html", "1 Minería de Datos 1.1 Motivación para la Mineria de datos 1.2 ¿Qué es la minería de datos? 1.3 Datos y conocimiento 1.4 Requerimientos 1.5 knowledge discovery in databases (KDD) 1.6 Preparación de los datos 1.7 Imputación de variables", " 1 Minería de Datos 1.1 Motivación para la Mineria de datos Los métodos de recoleccion de datos han evolucionado muy rápidamente. Las bases de datos han crecido exponencialmente Estos datos contienen información útil para las empresas, paises, etc.. El tamaño hace que la inspección manual sea casi imposible Se requieren métodos de análisis de datos automáticos para optimizar el uso de estos enormes conjuntos de datos 1.2 ¿Qué es la minería de datos? Es el análisis de conjuntos de datos (a menudo grandes) para encontrar relaciones insospechadas (conocimiento) y resumir los datos de formas novedosas que sean comprensibles y útiles para el propietario/usuario de los datos. Principles of Data Mining (Hand et.al. 2001) 1.3 Datos y conocimiento 1.3.1 Datos: se refieren a instancias únicas y primitivas (single objetos, personas, eventos, puntos en el tiempo, etc.) describir propiedades individuales a menudo son fáciles de recolectar u obtener (por ejemplo, cajeros de escáner, internet, etc.) no nos permiten hacer predicciones o pronósticos 1.3.2 Conocimiento: se refiere a clases de instancias (conjuntos de …) describe patrones generales, estructuras, leyes, consta de la menor cantidad de declaraciones posibles a menudo es difícil y lleva mucho tiempo encontrar u obtener nos permite hacer predicciones y pronósticos 1.4 Requerimientos Disponibilidad para aprender Mucha paciencia Interactúa con otras áreas Preprocesamiento de datos Creatividad Rigor, prueba y error 1.5 knowledge discovery in databases (KDD) 1.6 Preparación de los datos 1.6.1 Recopilación Instituto de Estadística UDAPE, ASFI Ministerio Salud (SNIS), Ministerio de educación (SIE) APIs, Twitter, Facebook, etc. Kaggle Banco Mundial, UNICEF, FAO, BID (Open Data) 1.6.2 Data Warehouse 1.6.3 Data Warehouse in R 1.6.4 Importación library(foreign) library(readr) apropos(&quot;read&quot;) ## [1] &quot;.rs.api.readPreference&quot; ## [2] &quot;.rs.api.readRStudioPreference&quot; ## [3] &quot;.rs.connectionReadDSN&quot; ## [4] &quot;.rs.connectionReadInstallers&quot; ## [5] &quot;.rs.connectionReadOdbc&quot; ## [6] &quot;.rs.connectionReadOdbcEntry&quot; ## [7] &quot;.rs.connectionReadPackageInstallers&quot; ## [8] &quot;.rs.connectionReadPackages&quot; ## [9] &quot;.rs.connectionReadSnippets&quot; ## [10] &quot;.rs.connectionReadWindowsRegistry&quot; ## [11] &quot;.rs.isREADME&quot; ## [12] &quot;.rs.odbcBundleReadIni&quot; ## [13] &quot;.rs.onAvailablePackagesReady&quot; ## [14] &quot;.rs.readAliases&quot; ## [15] &quot;.rs.readApiPref&quot; ## [16] &quot;.rs.readDataCapture&quot; ## [17] &quot;.rs.readFile&quot; ## [18] &quot;.rs.readIniFile&quot; ## [19] &quot;.rs.readLines&quot; ## [20] &quot;.rs.readPackageDescription&quot; ## [21] &quot;.rs.readPrefInternal&quot; ## [22] &quot;.rs.readRnbCache&quot; ## [23] &quot;.rs.readShinytestResultRds&quot; ## [24] &quot;.rs.readSourceDocument&quot; ## [25] &quot;.rs.readUiPref&quot; ## [26] &quot;.rs.readUserPref&quot; ## [27] &quot;.rs.readUserState&quot; ## [28] &quot;.rs.renv.readLockfilePackages&quot; ## [29] &quot;.rs.rnb.readConsoleData&quot; ## [30] &quot;read.arff&quot; ## [31] &quot;read.csv&quot; ## [32] &quot;read.csv2&quot; ## [33] &quot;read.dbf&quot; ## [34] &quot;read.dcf&quot; ## [35] &quot;read.delim&quot; ## [36] &quot;read.delim2&quot; ## [37] &quot;read.DIF&quot; ## [38] &quot;read.dta&quot; ## [39] &quot;read.epiinfo&quot; ## [40] &quot;read.fortran&quot; ## [41] &quot;read.ftable&quot; ## [42] &quot;read.fwf&quot; ## [43] &quot;read.mtp&quot; ## [44] &quot;read.octave&quot; ## [45] &quot;read.S&quot; ## [46] &quot;read.socket&quot; ## [47] &quot;read.spss&quot; ## [48] &quot;read.ssd&quot; ## [49] &quot;read.systat&quot; ## [50] &quot;read.table&quot; ## [51] &quot;read.xport&quot; ## [52] &quot;read_csv&quot; ## [53] &quot;read_csv_chunked&quot; ## [54] &quot;read_csv2&quot; ## [55] &quot;read_csv2_chunked&quot; ## [56] &quot;read_delim&quot; ## [57] &quot;read_delim_chunked&quot; ## [58] &quot;read_file&quot; ## [59] &quot;read_file_raw&quot; ## [60] &quot;read_fwf&quot; ## [61] &quot;read_lines&quot; ## [62] &quot;read_lines_chunked&quot; ## [63] &quot;read_lines_raw&quot; ## [64] &quot;read_lines_raw_chunked&quot; ## [65] &quot;read_log&quot; ## [66] &quot;read_rds&quot; ## [67] &quot;read_table&quot; ## [68] &quot;read_table2&quot; ## [69] &quot;read_tsv&quot; ## [70] &quot;read_tsv_chunked&quot; ## [71] &quot;readBin&quot; ## [72] &quot;readChar&quot; ## [73] &quot;readCitationFile&quot; ## [74] &quot;readClipboard&quot; ## [75] &quot;readline&quot; ## [76] &quot;readLines&quot; ## [77] &quot;readr_example&quot; ## [78] &quot;readRDS&quot; ## [79] &quot;readRegistry&quot; ## [80] &quot;readRenviron&quot; ## [81] &quot;Sys.readlink&quot; 1.6.5 Recopilación read.table(&quot;clipboard&quot;,header = T) library(readxl) library(dplyr) library(DBI) library(RMySQL) library(gtrendsR) # API 1.6.6 Limpieza std&lt;-data.frame(name=c(&quot;ana&quot;,&quot;juan&quot;,&quot;carla&quot;),math=c(86,43,80),stat=c(90,75,82)) std ## name math stat ## 1 ana 86 90 ## 2 juan 43 75 ## 3 carla 80 82 library(tidyr) bd&lt;-gather(std,materia,nota,math:stat) bd ## name materia nota ## 1 ana math 86 ## 2 juan math 43 ## 3 carla math 80 ## 4 ana stat 90 ## 5 juan stat 75 ## 6 carla stat 82 1.6.7 Ejercicio (reshape) http://www.udape.gob.bo/portales_html/dossierweb2019/htms/CAP07/C070311.xls 1.6.8 Limpieza (fechas) library(lubridate) ## ## Attaching package: &#39;lubridate&#39; ## The following objects are masked from &#39;package:base&#39;: ## ## date, intersect, setdiff, union ymd(&quot;20151021&quot;) ## [1] &quot;2015-10-21&quot; ymd(&quot;2015/11/30&quot;) ## [1] &quot;2015-11-30&quot; myd(&quot;11.2012.3&quot;) ## [1] &quot;2012-11-03&quot; dmy_hms(&quot;2/12/2013 14:05:01&quot;) ## [1] &quot;2013-12-02 14:05:01 UTC&quot; mdy(&quot;120112&quot;) ## [1] &quot;2012-12-01&quot; 1.6.9 Limpieza (String) toupper(&quot;hola&quot;) ## [1] &quot;HOLA&quot; abc&lt;-letters[1:10] toupper(abc) ## [1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; &quot;E&quot; &quot;F&quot; &quot;G&quot; &quot;H&quot; &quot;I&quot; &quot;J&quot; tolower(&quot;HOLA&quot;) ## [1] &quot;hola&quot; tolower(&quot;Juan&quot;) ## [1] &quot;juan&quot; substr(&quot;hola como estan&quot;,1,3) ## [1] &quot;hol&quot; substr(&quot;hola como estan&quot;,3,7) ## [1] &quot;la co&quot; nchar(&quot;hola&quot;) ## [1] 4 gsub(&quot;a&quot;,&quot;x&quot;,&quot;hola como estas&quot;) ## [1] &quot;holx como estxs&quot; grepl(&quot;a&quot;,c(&quot;hola&quot;,&quot;como&quot;)) ## [1] TRUE FALSE grepl(&quot;o&quot;,c(&quot;hola&quot;,&quot;como&quot;)) ## [1] TRUE TRUE library(stringi) 1.6.10 Transfomración Estandarizar variables Función logarítmo Creación de variables Recodificar variables 1.7 Imputación de variables We should be suspicious of any dataset (large or small) which appears perfect. — David J. Hand 1.7.1 La falta de información es información MCAR missing completely at random MAR missing at random MNAR missing not at random 1.7.2 Aproximación formal Sea \\(Y\\) una matriz de datos con \\(n\\) observaciones y \\(p\\) variables. Sea \\(R\\) una matriz de respuesta binaria, tal que si \\(y_{ij}\\) es observada, entonces \\(r_{ij}=1\\). Los valores observados son colectados en \\(Y_{obs}\\), las observaciones perdidas en \\(Y_{mis}\\). Así, \\(Y=(Y_{obs},Y_{mis})\\). La distribución de \\(R\\) depende de \\(Y=(Y_{obs},Y_{mis})\\). Sea \\(\\psi\\) que contiene los parametros del modelos de los datos perdidos, asi la expresion del modelo de los datos perdidos es \\(\\Pr(R|Y_\\mathrm{obs},Y_\\mathrm{mis},\\psi)\\) 1.7.3 MCAR, MAR, MNAR MCAR (missing completely at random ) \\[ \\Pr(R=0|{\\mbox{$Y_\\mathrm{obs}$}},{\\mbox{$Y_\\mathrm{mis}$}},\\psi) = \\Pr(R=0|\\psi) \\] MAR (missing at random ) \\[ \\Pr(R=0|{\\mbox{$Y_\\mathrm{obs}$}},{\\mbox{$Y_\\mathrm{mis}$}},\\psi) = \\Pr(R=0|{\\mbox{$Y_\\mathrm{obs}$}},\\psi) \\] MNAR (missing not at random ) \\[ \\Pr(R=0|{\\mbox{$Y_\\mathrm{obs}$}},{\\mbox{$Y_\\mathrm{mis}$}},\\psi) \\] 1.7.4 Alternativas para trabajar con los Missings (Ad-hoc) Listwise deletion Pairwise deletion Mean imputation Regression imputation Stochastic regression imputation Last observation carried forward (LOCF) and baseline observation carried forward (BOCF) Indicator method 1.7.5 Imputación Multiple 1.7.6 Patrones en datos multivariados 1.7.7 Influx and outflux \\[ I_j = \\frac{\\sum_j^p\\sum_k^p\\sum_i^n (1-r_{ij})r_{ik}}{\\sum_k^p\\sum_i^n r_{ik}} \\] La variable con mayor influx está mejor conectada a los datos observados y, por lo tanto, podría ser más fácil de imputar. \\[ O_j = \\frac{\\sum_j^p\\sum_k^p\\sum_i^n r_{ij}(1-r_{ik})}{\\sum_k^p\\sum_i^n 1-r_{ij}} \\] La variable con mayor outflux está mejor conectada a los datos faltantes, por lo tanto, es potencialmente más útil para imputar otras variables. 1.7.8 Imputación de datos monótonos 1.7.9 Multivariate Imputation by Chained Equations (mice) (Imputación multivariante por ecuaciones encadenadas) "],
["modelado-en-minería-de-datos.html", "2 Modelado en Minería de datos 2.1 Explorando los datos 2.2 Componentes Principales 2.3 Análisis de correspondencia", " 2 Modelado en Minería de datos 2.1 Explorando los datos Existen dos aproximaciones para empezar a explorar la información existente en una base de datos: Resumen de los datos Visualización de los datos 2.1.1 Resumen de los datos Dado el tamaño de las bases de datos resulta imposible o muy dificil conocer todas sus propiedad, el resumen de los datos intenta brindar propiedades claves de los datos, estas propiedades podrian ser: Cual es el valor mas comun Cuan variable o dispersa esta la informacion Existen valores extraños o inesparedaps en la base de datos Los datos siguen alguna distribucion A continuación se emplea la encuesta a hogares 2018 para ir respondiendo estas preguntas. En cuanto a los valores mas comunes, la media y la mediana de los datos son suficientes para las variables cuantitativas, mientra que para variables cualitativas, las categorias mas frecuentes son una buena opción. load(url(&quot;https://github.com/AlvaroLimber/EST-384/raw/master/data/eh18.Rdata&quot;)) # media de edad mean(eh18p$s02a_03) ## [1] 29.59059 #mediana de edad median(eh18p$s02a_03) ## [1] 26 # para las categorias mas frecuentes library(DMwR2) ## Registered S3 method overwritten by &#39;quantmod&#39;: ## method from ## as.zoo.data.frame zoo library(dplyr) ## ## Attaching package: &#39;dplyr&#39; ## The following objects are masked from &#39;package:stats&#39;: ## ## filter, lag ## The following objects are masked from &#39;package:base&#39;: ## ## intersect, setdiff, setequal, union #para el sexo centralValue(eh18p$s02a_02) ## [1] &quot;2.Mujer&quot; #para el departamento centralValue(eh18p$depto) ## [1] &quot;La Paz&quot; A veces es mejor ver los resultados por grupos, por ejemplo, podemos verlo por departamento y area. eh18p %&gt;% group_by(depto,area) %&gt;% summarise(mean(s02a_03),median(s02a_03),centralValue(s02a_02),n()) ## `summarise()` regrouping output by &#39;depto&#39; (override with `.groups` argument) ## # A tibble: 18 x 6 ## # Groups: depto [9] ## depto area `mean(s02a_03)` `median(s02a_03~ ## &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 Chuq~ Urba~ 28.7 24 ## 2 Chuq~ Rural 31.0 27 ## 3 La P~ Urba~ 30.4 27 ## 4 La P~ Rural 34.3 31 ## 5 Coch~ Urba~ 30.4 27 ## 6 Coch~ Rural 31.1 27.5 ## 7 Oruro Urba~ 28.7 26 ## 8 Oruro Rural 36.4 34 ## 9 Poto~ Urba~ 26.1 23 ## 10 Poto~ Rural 35.6 34.5 ## 11 Tari~ Urba~ 29.4 27 ## 12 Tari~ Rural 29.7 27 ## 13 Sant~ Urba~ 27.8 25 ## 14 Sant~ Rural 29.9 26 ## 15 Beni Urba~ 26.8 22 ## 16 Beni Rural 26.0 19 ## 17 Pando Urba~ 25.5 23 ## 18 Pando Rural 22.6 18 ## # ... with 2 more variables: `centralValue(s02a_02)` &lt;chr&gt;, ## # `n()` &lt;int&gt; La función n() realiza un proceso de conteo. De forma similar podemos hacer para las medidas de variabilidad, las mas comunes la desviacion estandar, el rango, el rango intercuartil y los cuantiles. Usando la eh18 para la edad y el ingreso laboral. ##EDAD # Desviacion estandar sd(eh18p$s02a_03) ## [1] 20.97181 # Rango range(eh18p$s02a_03) ## [1] 0 98 # Rango intercuartil IQR(eh18p$s02a_03) ## [1] 32 # Quantiles quantile(eh18p$s02a_03) ## 0% 25% 50% 75% 100% ## 0 12 26 44 98 quantile(eh18p$s02a_03,c(0.10,0.90)) ## 10% 90% ## 5 61 ##INGRESO LABORAL # Desviacion estandar sd(eh18p$ylab,na.rm = T) ## [1] 2242.593 # Rango range(eh18p$ylab,na.rm = T) ## [1] 4.166667 36196.667969 # Rango intercuartil IQR(eh18p$ylab,na.rm = T) ## [1] 2397 # Quantiles quantile(eh18p$ylab,na.rm = T) ## 0% 25% 50% 75% ## 4.166667 1500.000000 2554.699951 3897.000000 ## 100% ## 36196.667969 quantile(eh18p$s02a_03,probs=c(0.10,0.90),na.rm = T) ## 10% 90% ## 5 61 ##por departamento y area tapply(eh18p$ylab,list(eh18p$depto,eh18p$area),sd,na.rm=T)#opcion1 ## Urbana Rural ## Chuquisaca 2586.058 1735.306 ## La Paz 2154.421 1703.794 ## Cochabamba 2313.400 1654.140 ## Oruro 2425.280 1622.623 ## Potosí 2308.412 1534.399 ## Tarija 2287.537 2142.638 ## Santa Cruz 2156.938 2134.006 ## Beni 2419.952 1809.108 ## Pando 1778.112 2050.242 tapply(eh18p$ylab,list(eh18p$depto,eh18p$area),quantile,na.rm=T)#con problemas ## Urbana Rural ## Chuquisaca Numeric,5 Numeric,5 ## La Paz Numeric,5 Numeric,5 ## Cochabamba Numeric,5 Numeric,5 ## Oruro Numeric,5 Numeric,5 ## Potosí Numeric,5 Numeric,5 ## Tarija Numeric,5 Numeric,5 ## Santa Cruz Numeric,5 Numeric,5 ## Beni Numeric,5 Numeric,5 ## Pando Numeric,5 Numeric,5 aggregate(eh18p$ylab,list(depto=eh18p$depto,area=eh18p$area),quantile,na.rm=T) ## depto area x.0% x.25% x.50% ## 1 Chuquisaca Urbana 39.583336 1317.083344 2598.000000 ## 2 La Paz Urbana 6.666667 1732.000000 2650.000000 ## 3 Cochabamba Urbana 80.000000 1850.833374 2700.000000 ## 4 Oruro Urbana 15.000000 1608.679932 2598.000000 ## 5 Potosí Urbana 160.000000 1724.750000 3064.550049 ## 6 Tarija Urbana 86.599998 1794.533325 2814.500000 ## 7 Santa Cruz Urbana 80.000000 2121.699951 2976.875000 ## 8 Beni Urbana 50.000000 1729.834961 2500.000000 ## 9 Pando Urbana 250.000000 2475.000000 3291.666748 ## 10 Chuquisaca Rural 36.666668 519.599976 1012.489990 ## 11 La Paz Rural 12.500000 300.000000 825.000000 ## 12 Cochabamba Rural 23.333334 523.649994 1590.000061 ## 13 Oruro Rural 19.166668 286.458336 653.916687 ## 14 Potosí Rural 25.833334 225.000000 516.250000 ## 15 Tarija Rural 4.166667 995.883316 1967.666687 ## 16 Santa Cruz Rural 66.666672 1230.000000 2262.250000 ## 17 Beni Rural 100.000000 705.000000 1800.000000 ## 18 Pando Rural 80.000000 1207.500000 2167.500000 ## x.75% x.100% ## 1 4369.449707 16123.333008 ## 2 3897.000000 23437.484375 ## 3 4000.000000 36196.667969 ## 4 4330.000000 16166.666992 ## 5 4500.000000 14072.500000 ## 6 4330.000000 21833.000000 ## 7 4156.799805 35668.664062 ## 8 4105.924927 22700.000000 ## 9 4538.041748 11367.666016 ## 10 2078.399902 10120.000000 ## 11 2249.166748 15433.333008 ## 12 2598.000000 10825.000000 ## 13 2051.324982 10175.500000 ## 14 1435.208374 7333.333496 ## 15 3366.749939 16730.000000 ## 16 3167.366516 22465.667969 ## 17 3500.000000 7577.500000 ## 18 3449.133362 19750.000000 Finalmente, para explorar a fondo las variables la funcion describe es bastante útil, tambien, el comando summary. #analizando las 5 primeras variables de la base de datos library(Hmisc) ## Loading required package: lattice ## Loading required package: survival ## Loading required package: Formula ## Loading required package: ggplot2 ## ## Attaching package: &#39;Hmisc&#39; ## The following objects are masked from &#39;package:dplyr&#39;: ## ## src, summarize ## The following objects are masked from &#39;package:base&#39;: ## ## format.pval, units describe(eh18p[,1:5]) ## eh18p[, 1:5] ## ## 5 Variables 37517 Observations ## ------------------------------------------------------------ ## folio ## n missing distinct ## 37517 0 11195 ## ## lowest : 111-00419704629-A-0011 111-00419704629-A-0021 111-00419704629-A-0041 111-00419704629-A-0051 111-00419704629-A-0071 ## highest: 953-11761951198-D-0081 953-11761951198-D-0091 953-11761951198-D-0101 953-11761951198-D-0111 953-11761951198-D-0121 ## ------------------------------------------------------------ ## nro ## n missing distinct Info Mean Gmd ## 37517 0 13 0.948 2.639 1.712 ## .05 .10 .25 .50 .75 .90 ## 1 1 1 2 4 5 ## .95 ## 6 ## ## lowest : 1 2 3 4 5, highest: 9 10 11 12 13 ## ## Value 1 2 3 4 5 6 7 8 ## Frequency 11195 9399 7215 4892 2654 1230 536 231 ## Proportion 0.298 0.251 0.192 0.130 0.071 0.033 0.014 0.006 ## ## Value 9 10 11 12 13 ## Frequency 110 39 13 2 1 ## Proportion 0.003 0.001 0.000 0.000 0.000 ## ------------------------------------------------------------ ## depto ## n missing distinct ## 37517 0 9 ## ## lowest : Chuquisaca La Paz Cochabamba Oruro Potosí ## highest: Potosí Tarija Santa Cruz Beni Pando ## ## Chuquisaca (2117, 0.056), La Paz (9970, 0.266), Cochabamba ## (7578, 0.202), Oruro (2188, 0.058), Potosí (1855, 0.049), ## Tarija (3088, 0.082), Santa Cruz (6561, 0.175), Beni (2516, ## 0.067), Pando (1644, 0.044) ## ------------------------------------------------------------ ## area ## n missing distinct ## 37517 0 2 ## ## Value Urbana Rural ## Frequency 29212 8305 ## Proportion 0.779 0.221 ## ------------------------------------------------------------ ## s02a_02 ## n missing distinct ## 37517 0 2 ## ## Value 1.Hombre 2.Mujer ## Frequency 18419 19098 ## Proportion 0.491 0.509 ## ------------------------------------------------------------ summary(eh18p$ylab) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 4.17 1500.00 2554.70 2959.39 3897.00 36196.67 ## NA&#39;s ## 22852 by(eh18p[,c(&quot;ylab&quot;,&quot;p0&quot;,&quot;s02a_03&quot;)],eh18p$area,summary) ## eh18p$area: Urbana ## ylab p0 s02a_03 ## Min. : 6.67 No Pobre:21225 Min. : 0.00 ## 1st Qu.: 1839.08 Pobre : 7971 1st Qu.:13.00 ## Median : 2788.52 NA&#39;s : 16 Median :26.00 ## Mean : 3238.21 Mean :29.17 ## 3rd Qu.: 4082.50 3rd Qu.:43.00 ## Max. :36196.67 Max. :98.00 ## NA&#39;s :17573 ## --------------------------------------------- ## eh18p$area: Rural ## ylab p0 s02a_03 ## Min. : 4.167 No Pobre:4049 Min. : 0.00 ## 1st Qu.: 476.392 Pobre :4254 1st Qu.:11.00 ## Median : 1300.000 NA&#39;s : 2 Median :27.00 ## Mean : 1886.938 Mean :31.06 ## 3rd Qu.: 2657.667 3rd Qu.:49.00 ## Max. :22465.668 Max. :98.00 ## NA&#39;s :5279 2.1.2 Visualización La visualizacion es una herramienta importante para explorar y entender la base de datos. Los seres humanos son excelentes para capturar patrones visuales, y la visualización de datos intenta capitalizar en estas habilidades. Es util diferenciar las visualizaciones por: Una sola varibles Dos variables Multiples variables Los aspetor vinculados al uso de graficos de origen de R y la libreria ggplot pueden verse en el texto guia de EST-183 “BigData”. A continuación se introducen de forma directa funciones en R orientadas a la visualización univariante, bivariante y multivariante. Usando al EH-2018, para variables cualitativas. #Graficos de origen de R barplot(table(eh18p$s03a_01a),main=&quot;Dónde vivia hace 5 años?&quot;) #GGPLOT library(ggplot2) ggplot(eh18p,aes(x=s03a_01a))+geom_bar()+ggtitle(&quot;Dónde vivia hace 5 años?&quot;) Para variables del tipo cuantitativas par(mfrow=c(1,2)) boxplot(eh18p$ylab) hist(eh18p$ylab) dev.off() ## null device ## 1 ggplot(eh18p,aes(ylab))+geom_boxplot() ## Warning: Removed 22852 rows containing non-finite values ## (stat_boxplot). ggplot(eh18p,aes(ylab))+geom_histogram() ## `stat_bin()` using `bins = 30`. Pick better value with ## `binwidth`. ## Warning: Removed 22852 rows containing non-finite values ## (stat_bin). Si ahora queremos comparar usar ambas variables cuanti y cuali boxplot(eh18p$ylab~eh18p$s03a_01a) ggplot(eh18p,aes(x=s03a_01a,y=ylab))+geom_boxplot() ## Warning: Removed 22852 rows containing non-finite values ## (stat_boxplot). ggplot(eh18p,aes(x=s03a_01a,y=ylab))+geom_violin() ## Warning: Removed 22852 rows containing non-finite values ## (stat_ydensity). Usando ambas variables cuantitativas plot(eh18p$tothrs,eh18p$ylab) plot(eh18p[,c(&quot;ylab&quot;,&quot;tothrs&quot;,&quot;aestudio&quot;)]) #pairs(eh18p[,c(&quot;ylab&quot;,&quot;tothrs&quot;,&quot;aestudio&quot;)]) similar al anterior library(GGally) ggpairs(eh18p,columns = c(&quot;ylab&quot;,&quot;tothrs&quot;,&quot;aestudio&quot;)) library(ggridges) # basic example ggplot(eh18p[eh18p$s02a_03&gt;=15,], aes(x = ylab, y = s02a_02, fill = s02a_02)) + geom_density_ridges() + theme_ridges() + theme(legend.position = &quot;none&quot;)+ ggtitle(&quot;Ingreso laboral por sexo, personas de 15 años o más&quot;) Ahora si combinamos variables cuanti y cuali con ggpairs. ggpairs(eh18p,columns = c(&quot;ylab&quot;,&quot;tothrs&quot;,&quot;s03a_01a&quot;,&quot;area&quot;)) Alternativas Multivariantes, #trabajando a partir de una muestra de 100 individuos s&lt;-sample(1:dim(eh18p)[1],100) i&lt;-match(c(&quot;s02a_03&quot;,&quot;aestudio&quot;,&quot;ylab&quot;,&quot;tothrs&quot;),names(eh18p)) ggparcoord(eh18p[s,],columns = i,groupColumn = &quot;area&quot;,boxplot=T) library(&quot;TeachingDemos&quot;) ## ## Attaching package: &#39;TeachingDemos&#39; ## The following objects are masked from &#39;package:Hmisc&#39;: ## ## cnvrt.coords, subplot faces(na.omit(eh18p[s,i])) 2.2 Componentes Principales El método de Análisis de Componentes Principales se ocupa de explicar la estructura de varianza y covarianza de un grupo de variables a través de unas pocas combinaciones lineales de este grupo de variables. En general sus objetivos son (1) la reducción de los datos y (2) la interpretación. Algebráicamente, los componentes principales son combinaciones lineales de \\(p\\) variables aleatorias \\(X_1\\), \\(X_2\\), , \\(X_p\\). Geométricamente, estas combinaciones lineales representan la selección de un nuevo sistema de coordenadas obtenido por rotación de del sistema original con \\(X_1\\), \\(X_2\\), , \\(X_p\\) como los ejes de coordenadas. Los nuevos ejes representan la dirección con la máxima variabilidad y provee una simple y más parsimoniosa descripción de la estructura de la covarianza. Los componentes principales dependen únicamente de la matriz de covarianza \\(\\Sigma\\) o la matriz de correlaciones \\(\\rho\\) (Matriz estandarizada de \\(\\Sigma\\)) de \\(X_1\\), \\(X_2\\), , \\(X_p\\). Su desarrollo no requiere de ningún supuesto de normalidad multivariada, sin embargo, componentes principales derivados de poblaciones normales multivariantes tienen un gran uso en la interpretación en términos de elipsoide de densidad constante. Sea la matriz \\(\\mathbf{X}\\) compuesta de \\(p\\) vectores aleatorios \\(\\mathbf{X}=[X_1, X_2, \\ldots, X_p ]\\) que tiene la matriz de covarianza \\(\\Sigma\\) con valores propios \\(\\lambda_1 \\geq \\lambda_2 \\geq \\ldots \\geq \\lambda_p \\geq 0\\). Considere la combinación lineal: \\[\\begin{equation} \\begin{array}{rrr} Y_1 = &amp; a_1^{&#39;} \\mathbf{X} = &amp; a_{11} X_1 + a_{12} X_2 + \\ldots a_{1p} X_p \\\\ Y_2 = &amp; a_2^{&#39;} \\mathbf{X} = &amp; a_{21} X_1 + a_{22} X_2 + \\ldots a_{2p} X_p\\\\ \\vdots = &amp; \\vdots &amp; \\vdots \\\\ Y_p = &amp; a_p^{&#39;} \\mathbf{X} = &amp; a_{p1} X_1 + a_{p2} X_2 + \\ldots a_{pp} X_p\\\\ \\end{array} \\label{cp1} \\end{equation}\\] Equivalente a: \\[\\begin{equation} \\mathbf{Y}= \\left[ \\begin{array}{c} Y_1\\\\ Y_2\\\\ \\vdots\\\\ Y_p\\\\ \\end{array} \\right] = \\left[ \\begin{array}{cccc} a_{11} &amp; a_{12} &amp; \\ldots &amp; a_{1p} \\\\ a_{21} &amp; a_{22} &amp; \\ldots &amp; a_{2p} \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ a_{21} &amp; a_{p2} &amp; \\ldots &amp; a_{pp} \\\\ \\end{array} \\right] \\left[ \\begin{array}{c} X_1\\\\ X_2\\\\ \\vdots\\\\ X_p\\\\ \\end{array} \\right] = \\mathbf{A X} \\label{cp2} \\end{equation}\\] La combinación lineal \\(\\mathbf{Y}=\\mathbf{AX}\\) tiene: \\[\\begin{equation} \\mu_y=E(\\mathbf{Y})=E(\\mathbf{AX})=A \\mu_x \\label{cp3} \\end{equation}\\] \\[\\begin{equation} \\Sigma_y=Cov(\\mathbf{Y})=Cov(\\mathbf{AX})=A \\Sigma A^{&#39;} \\label{cp4} \\end{equation}\\] En base a , se obtiene: \\[\\begin{equation} Var(Y_i)=a_i^{&#39;} \\Sigma a_i \\quad i=1, 2, \\ldots, p \\label{cp5} \\end{equation}\\] \\[\\begin{equation} Cov(Y_i,Y_k)=a_i^{&#39;} \\Sigma a_k \\quad i,k=1, 2, \\ldots, p \\label{cp6} \\end{equation}\\] Los componentes principales son combinaciones lineales incorrelacionadas, tal que es lo más grande posible. El primer componente principal es la combinación lineal con máxima varianza. Entonces se debe maximizar \\(Var(Y_1)=a_1^{&#39;} \\Sigma a_1\\). Es claro que \\(Var(Y_1)\\) puede ser incrementada multiplicando a \\(a_1\\) por alguna constante. Para eliminar esta indeterminación, es conveniente restringir los coeficientes del vector. Por lo tanto se define. \\[ \\begin{array}{rcl} \\text{Primer componente principal} &amp; = &amp; \\text{Combinacion lineal} \\quad a_1^{&#39;}X \\quad \\text{que maximiza} \\\\ &amp; &amp; Var(a_1^{&#39;}X) \\quad \\text{sujeto a} \\quad a_1^{&#39;} a_1=1\\\\ \\text{Segundo componente principal} &amp; = &amp; \\text{Combinacion lineal} \\quad a_2^{&#39;}X \\quad \\text{que maximiza} \\\\ &amp; &amp; Var(a_2^{&#39;}X) \\quad \\text{sujeto a} \\quad a_2^{&#39;} a_2=1 \\quad y \\\\ &amp; &amp; Cov(a_1^{&#39;}X,a_2^{&#39;}X)=0 \\end{array} \\] Para el \\(i-esimo\\) paso: \\[ \\begin{array}{rcl} i-esimo \\text{ componente principal} &amp; = &amp; \\text{Combinacion lineal} \\quad a_i^{&#39;}X \\quad \\text{que maximiza} \\\\ &amp; &amp; Var(a_i^{&#39;}X) \\quad \\text{sujeto a} \\quad a_i^{&#39;} a_i=1 \\quad y \\\\ &amp; &amp; Cov(a_i^{&#39;}X,a_k^{&#39;}X)=0 \\quad para \\quad k&lt;i \\end{array} \\] Los pasos sugeridos para iniciar el analisis de componentes principales son: Identificar las variables de interés dentro de la matriz de datos, si las variables tienen las mismas escalas se recomienda emplear la matriz de covarianza, si las escalas son diferentes, se recomienda trabajar con la matriz de correlaciones. Obtener los componentes principales, los eigen valores y la matriz de eigen vectores Eliminar las variables rebundantes, se sugiere identificar las variables del conjunto de datos correlacionadas con los últimos componentes Calcular nuevamente los componentes principales expluyendo las variables identificadas en el paso previo Elegir el número de componentes a retener (scree plot, tamaño de los eigen valores, etc) Analizar los resultados #1. Seleccione una base de datos de interés del repositorio load(url(&quot;https://github.com/AlvaroLimber/EST-384/blob/master/data/oct20.RData?raw=true&quot;)) #2. Seleccione las variables para el PCA (Según la motivación) vv&lt;-c(14:22,24,25) #2A TRANFORMAR vval&lt;-apply(computo[,vv],1,sum) aux&lt;-computo[,vv]/vval #2B LIMPIEZA #3. Calcule el PCA aux1&lt;-na.omit(aux) cp1&lt;-eigen(cov(aux1)) cp2&lt;-eigen(cor(aux1)) #4. Identifique el número de CPs que explican hasta el 90% de la varianza cumsum(cp1$values)/sum(cp1$values) ## [1] 0.6437488 0.8650934 0.9435882 0.9722772 0.9839750 ## [6] 0.9903314 0.9952079 0.9977119 0.9991579 1.0000000 ## [11] 1.0000000 cumsum(cp2$values)/sum(cp2$values) ## [1] 0.2060107 0.3791103 0.4915437 0.5920446 0.6774866 ## [6] 0.7601857 0.8319256 0.8991550 0.9562490 1.0000000 ## [11] 1.0000000 #5. Identifique las variables correlacionadas con la cantidad de #componentes fuera del 90% del paso anterior cp11cov&lt;-as.matrix(aux1)%*%cp1$vectors[,11] cp11cor&lt;-as.matrix(aux1)%*%cp2$vectors[,11] cor(cbind(aux1,cp11cov,cp11cor))[1:11,12:13] ## cp11cov cp11cor ## CC 0.53979440 -0.30842297 ## FPV -0.55376059 0.21633850 ## MTS 0.13333915 0.40515623 ## UCS -0.34677314 0.35428285 ## MAS - IPSP -0.21854796 -0.41971569 ## 21F -0.38433159 0.53263368 ## PDC -0.12174043 -0.01216537 ## MNR -0.21628303 0.41542663 ## PAN-BOL 0.11710134 0.09577694 ## Blancos -0.07666553 0.50453525 ## Nulos -0.11039942 0.18712933 cp11&lt;-eigen(cov(aux1[,-2])) cumsum(cp11$values)/sum(cp11$values) ## [1] 0.6443329 0.8658697 0.9444240 0.9730984 0.9847943 ## [6] 0.9911498 0.9960295 0.9984949 0.9999206 1.0000000 cp10cov&lt;-as.matrix(aux1[,-2])%*%cp11$vectors[,10] #6. Calcule nuevamente el componente principal eliminando las variables rebundantes #7. Determine la cantidad de componentes principales a retener cp1cov&lt;-as.matrix(aux1[,-2])%*%cp11$vectors[,1] cp2cov&lt;-as.matrix(aux1[,-2])%*%cp11$vectors[,2] plot(cp1cov,cp2cov) #8. Defina un indicador a partir de estos cor(cbind(aux1,cp1cov,cp2cov))[1:11,12:13] ## cp1cov cp2cov ## CC 0.92113465 0.35759774 ## FPV -0.08074887 -0.10802564 ## MTS -0.16786500 -0.30855895 ## UCS 0.14139049 -0.22216012 ## MAS - IPSP -0.92337643 0.36777758 ## 21F 0.32455320 -0.47209833 ## PDC -0.09883288 0.43937850 ## MNR 0.19561852 -0.25724983 ## PAN-BOL 0.04776390 -0.01901819 ## Blancos -0.17330606 -0.88168972 ## Nulos -0.08874645 0.06391096 bd&lt;-cbind(aux1,cp1cov,cp2cov) names(bd)[5]&lt;-&quot;MAS&quot; #9. Modele un modelo lineal empleando los CPs retenidos. summary(lm(MAS~cp1cov,data=bd)) ## ## Call: ## lm(formula = MAS ~ cp1cov, data = bd) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.39544 -0.05881 0.01417 0.06187 0.16168 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 0.3407735 0.0003141 1085.0 &lt;2e-16 *** ## cp1cov -0.7053686 0.0011240 -627.5 &lt;2e-16 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.07868 on 68069 degrees of freedom ## Multiple R-squared: 0.8526, Adjusted R-squared: 0.8526 ## F-statistic: 3.938e+05 on 1 and 68069 DF, p-value: &lt; 2.2e-16 2.3 Análisis de correspondencia El analisis de correspondencia esta orientado a encontrar relaciones entre las categorias de variables cualitativas. Esta técnica es un método visual que va más alla del test de independencia Chi-cuadrado. Para resumir la teoría, primero divida la matriz de datos \\(I × J\\), denotada por \\(N\\), por su gran total \\(n\\) para obtener la llamada matriz de correspondencia \\(P = N / n\\). Deje que los totales marginales de fila y columna de \\(P\\) sean los vectores \\(r\\) y \\(c\\) respectivamente, es decir, los vectores de masas de fila y columna, y \\(Dr\\) y \\(Dc\\) sean las matrices diagonales de estas matrices. El algoritmo computacional para obtener coordenadas de los perfiles de fila y columna con respecto a los ejes principales, usando el SVD, es el siguiente: Calcular la matriz de residuos estadarizados: \\(S=D_r^{-1/2}(P-rc^t)D_c^{-1/2}\\) Calcular la descomposición SVD de \\(S\\): \\(S=UD_{\\alpha}V^t\\), donde \\(U^T U=V^T V=I\\) Coordenadas principales de filas: \\(F=D_r^{-1/2} U D_{\\alpha}\\) Coordenadas principales de columnas: \\(G=D_c^{-1/2} V D_{\\alpha}\\) Coordenadas estándar de filas: \\(X=D_r^{-1/2} U\\) Coordenadas estándar de columnas: \\(Y=D_c^{-1/2} V\\) Calcular la Inercia: \\[\\phi^2=\\sum_i^I\\sum_j^J{\\frac{(p_{ij}-r_i c_j)^2}{r_i c_j}}\\] Graficar las coordenadas de F y G según la la inercia contenida en la matriz \\(D_{\\alpha}\\) En R, existe la libreria ca que permite acceder a las coordenadas del método de correspondencia. #ejemplo CA #install.packages(&quot;ca&quot;) library(dplyr) library(ca) data(&quot;smoke&quot;) model&lt;-ca(smoke) plot(model) names(model) summary(model) #ejemplo ENDSA load(url(&quot;https://github.com/AlvaroLimber/EST-384/raw/master/data/endsa.RData&quot;)) ll&lt;-attributes(endsa) ll$var.labels t1&lt;-endsa %&gt;% filter(year==2008) %&gt;% select(7,14) %&gt;% table() t1&lt;-t1[1:4,] #test chi2 chisq.test(t1) model&lt;-ca(t1) model plot(model) #programando el ca lcol&lt;-colnames(t1) lrow&lt;-rownames(t1) P&lt;-prop.table(t1) r&lt;-margin.table(P,1) c&lt;-margin.table(P,2) Dr&lt;-diag(r) Dc&lt;-diag(c) ##Paso 1 P-r%*%t(c) #error en las matriz diagonales Dr^(-0.5)%*%(P-r%*%t(c))%*% Dc^(-0.5) # corrigiendo el problema S&lt;-diag(r^(-0.5))%*%(P-r%*%t(c))%*% diag(c^(-0.5)) # 2 descomposición SVD svd(S) U&lt;-svd(S)$u V&lt;-svd(S)$v Da&lt;-diag(svd(S)$d) #verificando las propiedades U %*% t(U) t(V) %*% V U %*% Da %*% t(V) S # 3 Coordenadas principales filas FF&lt;- diag(r^(-0.5)) %*% U %*% Da # 4 Coordenadas principales columnas G&lt;- diag(c^(-0.5)) %*% V %*% Da # 5 Coordenadas estandar filas X&lt;- diag(r^(-0.5)) %*% U # 6 Coordenadas estandar columnas Y&lt;- diag(c^(-0.5)) %*% V # 7 inercia sum(((P-r%*%t(c))**2)/(r%*%t(c))) #graficando xmin&lt;-min(c(FF[,1],G[,1])) xmax&lt;-max(c(FF[,1],G[,1])) ymin&lt;-min(c(FF[,2],G[,2])) ymax&lt;-max(c(FF[,2],G[,2])) plot(FF[,1],FF[,2],col=&quot;red&quot;,xlim=c(xmin,xmax)*1.5,ylim=c(ymin,ymax)*1.1) points(G[,1],G[,2],col=&quot;blue&quot;) abline(h=0,v=0,lty=2) #incluyendo el texto plot(FF[,1],FF[,2],xlim=c(xmin,xmax)*1.5,ylim=c(ymin,ymax)*1.1,type = &quot;n&quot;) text(FF[,1],FF[,2],labels = lrow,col=&quot;red&quot;,cex=0.7) text(G[,1],G[,2],labels = lcol,col=&quot;blue&quot;,cex=0.7) abline(h=0,v=0,lty=2) #incluyendo mas información plot(FF[,1],FF[,2],xlim=c(xmin,xmax)*1.5,ylim=c(ymin,ymax)*1.1,type = &quot;n&quot;) text(FF[,1],FF[,2],labels = lrow,col=&quot;red&quot;,cex=0.5+r*2) text(G[,1],G[,2],labels = lcol,col=&quot;blue&quot;,cex=0.5+c*2) abline(h=0,v=0,lty=2) #viendo solo una dimensión plot(rep(0,dim(FF)[1]),FF[,1],type = &quot;n&quot;, axes = F) axis(2) text(rep(0,dim(FF)[1]),FF[,1],labels = lrow,col=&quot;red&quot;,cex=0.5+r*2) text(rep(0,dim(G)[1]),G[,1],labels = lcol,col=&quot;blue&quot;,cex=0.5+c*2) abline(h=0,v=0,lty=2) "],
["clustering.html", "3 Clustering 3.1 Medidas de Disimilaridad 3.2 Métodos de clustering 3.3 K-center Clustering (no jerárquicos) 3.4 Cluster Jerárquico 3.5 Ejercicios", " 3 Clustering El clustering es un método cuyo objetivo es el de crear grupos en base a las relaciones multivariantes que existen en los datos, este método es un método previo a las técnicas de clasificación que existen. La base del clustering es la definición de la similaridad entre las filas. Similaridad es definida como una función de distancia entre un par de filas. Es importante distinguir la existencia de grupos naturales dentro de los datos, normalmente estos grupos son características naturales de las observaciones de interés. 3.1 Medidas de Disimilaridad Dado el objetivo del clustering, el aspecto mas importante dentro de estos métodos es utilizar de forma correcta la medida de (di)similaridad entre un para de casos dentro de la base de datos. La definición de las medidas de distancia es crucial para aplicar estos modelos. Funciones de distancia incorrecta pueden generar sesgos en los resultados y ser un problema para etapas posteriores de la mineria de datos. Debemos distinguir las funciones de distancia segun la naturaleza de las variables. Sean las filas \\(x\\) e \\(y\\) dentro de una base de datos, estos vectores tienen una dimensión \\(p\\), es decir, se observan \\(p\\) variables para las 2 observaciones. 3.1.1 Distancia Euclideana: Variables numéricas \\[d(x,y)=\\sqrt{\\sum_{i=1}^p{(x_i-y_i)^2}}\\] Donde los \\(x_i\\) y \\(_y_i\\) son los valores para la variable \\(i\\) de las observaciones \\(x\\) e \\(y\\). 3.1.2 Distancia Manhattan: \\(p\\) grande \\[d(x,y)=\\sum_{i=1}^p{|x_i-y_i|}\\] 3.1.3 Distancia Minkowski \\[d(x,y)=\\left(\\sum_{i=1}^p{|x_i-y_i|^d}\\right)^{1/d}\\] aux&lt;-matrix(rnorm(100),nrow=5) dist(aux) #euclideana ## 1 2 3 4 ## 2 7.441070 ## 3 5.183985 4.772644 ## 4 5.666009 7.284590 5.026501 ## 5 6.639942 8.357878 6.528404 6.679651 dist(aux, method=&quot;manhattan&quot;) ## 1 2 3 4 ## 2 28.86663 ## 3 17.87844 18.71697 ## 4 19.84966 26.89624 18.59886 ## 5 26.64592 29.47988 22.00081 24.49906 dist(aux, method=&quot;minkowski&quot;, p=3) ## 1 2 3 4 ## 2 5.044889 ## 3 3.778457 3.188857 ## 4 3.923814 5.175254 3.427197 ## 5 4.445909 5.758418 4.644880 4.671012 3.1.4 programando minkowski&lt;-function(x,y,d){ dd&lt;-(sum(abs(x-y)**d))**(1/d) return(dd) } minkowski(c(1,2,3),c(4,2,1),d=2) ## [1] 3.605551 x&lt;-c(1,2,3) y&lt;-c(4,2,1) sum(abs(x-y)) # manhattan ## [1] 5 sqrt(sum(abs(x-y)**2)) # euclideana ## [1] 3.605551 # la funcion de distancia distancia&lt;-function(bd,d=2){ nf&lt;-dim(bd)[1] DD&lt;-matrix(NA,nf-1,nf-1) colnames(DD)&lt;-1:(nf-1) rownames(DD)&lt;-2:nf for(i in 1:(nf-1)){ for(j in (i+1):nf){ DD[j-1,i]&lt;-minkowski(bd[i,],bd[j,],d) } } return(DD) } distancia(aux,d=2) ## 1 2 3 4 ## 2 7.441070 NA NA NA ## 3 5.183985 4.772644 NA NA ## 4 5.666009 7.284590 5.026501 NA ## 5 6.639942 8.357878 6.528404 6.679651 dist(aux) ## 1 2 3 4 ## 2 7.441070 ## 3 5.183985 4.772644 ## 4 5.666009 7.284590 5.026501 ## 5 6.639942 8.357878 6.528404 6.679651 3.1.5 Variables cualitativas Para las variables cualitativas se debe considerar los casos cuando estas son nominales y ordinales, distinguir tambien los casos de variables binarias. install.packages(&quot;vegan&quot;) library(vegan) 3.1.6 Datos mixtos Una de los mayores desafios es cuando las variables son mixtas, es decir cuantitativas y cualitativas. install.packages(&quot;cluster&quot;) library(cluster) 3.2 Métodos de clustering Partición (k-center) Jerárquicos (dendograma) Basados en densidad Basados en cuadrículas (grid) 3.3 K-center Clustering (no jerárquicos) Algoritmo Partición de las observaciones en \\(k\\) grupos, obtener el vector de promedios de cada grupo (centroides). Se puede trabajar con la media o la mediana. Para cada observación calcular las distancia euclideana a los centroides y reasignar lo observación en base a la menor distancia, recalcular los centroides en base a la reasignación de cada observación Repetir el paso 2 hasta que que ya no existan más reasignaciones bd&lt;-data.frame(x=rnorm(100),y=rnorm(100)) kmeans(bd,2) ## K-means clustering with 2 clusters of sizes 43, 57 ## ## Cluster means: ## x y ## 1 0.7643897 -0.1921172 ## 2 -0.8273023 0.1888646 ## ## Clustering vector: ## [1] 2 1 1 1 2 2 2 1 1 2 2 2 1 1 2 2 2 2 1 1 2 2 2 2 2 1 1 ## [28] 1 2 1 2 1 2 2 2 2 2 2 1 2 1 2 1 2 1 2 2 1 2 1 2 1 1 2 ## [55] 1 1 2 2 2 1 2 1 2 2 2 2 2 2 1 1 1 2 1 1 2 2 1 2 2 1 1 ## [82] 1 1 1 2 2 2 2 2 2 2 1 1 2 1 1 1 2 2 1 ## ## Within cluster sum of squares by cluster: ## [1] 33.48058 73.56780 ## (between_SS / total_SS = 38.0 %) ## ## Available components: ## ## [1] &quot;cluster&quot; &quot;centers&quot; &quot;totss&quot; ## [4] &quot;withinss&quot; &quot;tot.withinss&quot; &quot;betweenss&quot; ## [7] &quot;size&quot; &quot;iter&quot; &quot;ifault&quot; Ejemplo: Implementar el algoritmo para el k-center, con la distancia de Minkowski y para la media y mediana. #Nota: La entrada de la funcion es un data frame kcenter&lt;-function(bd,k=3,d=2,tipo=&quot;media&quot;,seed=123456){ nf&lt;-dim(bd)[1] nc&lt;-dim(bd)[2] #paso1: asignar las k (nf&gt;=k) set.seed(seed) bd$k&lt;-sample(1:k,nf,replace=T) centroide&lt;-NULL for(i in 1:k){ if(tipo==&quot;media&quot;){ centroide&lt;-rbind(centroide,apply(bd[bd$k==i,],2, mean)) } else if(tipo==&quot;mediana&quot;){ centroide&lt;-rbind(centroide,apply(bd[bd$k==i,],2, median)) } } #paso2 (recalcular loo centroides al final) cc&lt;-1 while(cc!=0){ #paso3 cc&lt;-0 for(i in 1:nf){ auxd&lt;-NULL for(j in 1:k){ auxd&lt;-c(auxd,minkowski(bd[i,1:nc],centroide[j,1:nc],d=d)) } newk&lt;-which(auxd==min(auxd)) if(newk!=bd$k[i]){ bd$k[i] &lt;- newk cc&lt;-cc+1 } } centroide&lt;-NULL for(i in 1:k){ if(tipo==&quot;media&quot;){ centroide&lt;-rbind(centroide,apply(bd[bd$k==i,],2, mean)) } else if(tipo==&quot;mediana&quot;){ centroide&lt;-rbind(centroide,apply(bd[bd$k==i,],2, median)) } } } return(bd) } Pensar en un gráfico que permita ver como se asignaron los cluster bd&lt;-data.frame(x=rnorm(100),y=rnorm(100),z=rnorm(100)) kcenter(bd,k=4,d=1,tipo=&quot;mediana&quot;) ## x y z k ## 1 0.14201866 -0.125193670 -0.72777255 2 ## 2 0.06110902 -0.599238036 -0.25405843 4 ## 3 0.12462536 -0.001114346 -0.20090412 4 ## 4 1.92216926 0.405663042 -0.83302709 1 ## 5 -0.50855957 -0.260650801 -0.84516250 2 ## 6 1.10448126 -0.678944906 0.32468301 4 ## 7 1.45181508 -0.622930983 0.54245568 4 ## 8 -0.72935640 1.951846792 0.56799636 3 ## 9 0.14691978 -0.531271780 0.36392083 4 ## 10 1.05538052 0.668153532 0.97675043 1 ## 11 0.94730232 -0.595985538 1.41723962 4 ## 12 1.28471015 0.781495045 0.44993330 1 ## 13 1.30345517 -1.370587276 0.68500493 4 ## 14 0.09318983 0.524362841 -1.09898376 1 ## 15 1.90844155 0.022509339 -0.23612571 1 ## 16 -0.78786295 0.011979268 -1.16672502 2 ## 17 0.50931769 0.867623777 -1.57915303 1 ## 18 -0.54733363 -0.052299288 0.52844196 3 ## 19 -0.71539597 1.029898143 -0.46130851 3 ## 20 -0.39753811 -0.019601203 0.31790062 4 ## 21 0.03071449 1.308735417 -0.50128012 1 ## 22 0.12109080 -0.492807708 0.02433229 4 ## 23 0.06360468 0.822131309 1.89565793 3 ## 24 -1.40658519 -0.667402403 -0.01758830 2 ## 25 0.72366418 -0.966736847 -0.52667486 4 ## 26 1.33809747 0.222991727 -1.17058816 1 ## 27 0.45315784 -1.114770246 0.10724017 4 ## 28 0.33391745 -0.777538112 -1.62225228 4 ## 29 0.53072094 -1.383274250 0.21380939 4 ## 30 -0.87502125 -1.134683601 -0.36618294 2 ## 31 -0.10600674 0.076220902 -0.49221147 2 ## 32 -0.37233372 1.691206328 -0.55594723 3 ## 33 -0.92635090 -1.296591050 -0.37069557 2 ## 34 -0.59866309 1.232196460 0.51243808 3 ## 35 0.84188136 0.631815675 -0.62311540 1 ## 36 -0.44753138 -0.511032282 0.44892686 4 ## 37 0.63061805 0.309370609 0.70193378 1 ## 38 -0.05755284 0.975911609 -0.52566210 1 ## 39 0.83775184 0.769326044 -0.31261532 1 ## 40 -0.85419422 0.140426698 1.43380923 3 ## 41 -2.62159035 -0.029299410 -1.76788835 2 ## 42 -0.41355616 0.324842217 -0.09657654 3 ## 43 0.21958478 1.684862727 0.76712099 3 ## 44 0.53399462 0.695401734 0.58622641 1 ## 45 -0.63038740 1.170041735 0.69538819 3 ## 46 0.10348917 -0.850940313 0.87899104 4 ## 47 0.26490609 -0.131313490 -0.25139340 4 ## 48 -0.61072495 -0.364072326 -0.00322328 2 ## 49 0.88817422 0.846625398 0.63735572 1 ## 50 -1.25841925 -0.032979310 -0.76544063 2 ## 51 -0.09479785 0.210748643 0.15364185 4 ## 52 -1.78956329 1.313006766 0.14105773 3 ## 53 -2.43724514 0.117455540 0.21979341 2 ## 54 -0.53922980 1.813725126 -1.26201150 3 ## 55 -1.51399398 -1.149653921 -0.15377492 2 ## 56 2.29620990 0.951595130 -0.55912372 1 ## 57 -0.87455827 -1.459631171 -0.60618383 2 ## 58 -1.02329328 -0.626521312 -0.67830804 2 ## 59 1.03211762 1.068318433 0.50272251 1 ## 60 0.12917426 -0.393958863 -1.07388815 2 ## 61 -0.10289303 0.783233287 1.31625950 3 ## 62 -0.19540469 -1.415727065 2.22074251 4 ## 63 0.05884515 -1.068756075 1.57993161 4 ## 64 -0.49158834 1.952437263 1.14216556 3 ## 65 0.13269731 -1.483873253 0.76433399 4 ## 66 0.17129373 2.360265205 -0.61987816 1 ## 67 1.63377093 -0.282332032 -0.24049162 1 ## 68 0.18833382 0.412619620 -0.11394680 1 ## 69 -1.58776834 -1.300485284 -1.34150262 2 ## 70 -0.18352575 -1.524403402 0.41281109 4 ## 71 -2.24039052 0.005047006 -2.05099716 2 ## 72 -0.55165635 0.319613377 -0.35410088 2 ## 73 -0.73433048 -0.734267931 -0.31448218 2 ## 74 -0.43406087 -0.431940690 -0.33605852 2 ## 75 0.15677532 0.748895978 0.65115735 3 ## 76 -1.51047766 0.670545364 0.41442001 3 ## 77 -1.53904163 -0.177403936 -2.87710840 2 ## 78 1.31916131 0.201058067 -0.70874554 1 ## 79 0.93944177 -0.770598681 0.78481450 4 ## 80 0.76297914 1.920408978 -1.08743313 1 ## 81 0.52569102 -0.958039618 1.32269364 4 ## 82 0.36523836 -0.008328307 -1.79906521 1 ## 83 -0.06219007 -0.265526638 0.86264353 4 ## 84 -0.61461319 1.481679698 -0.57822964 3 ## 85 0.97537946 1.178120672 -0.31388702 1 ## 86 -0.96215857 0.587794481 -1.45191301 2 ## 87 1.56394398 0.708214348 -0.10328420 1 ## 88 -0.74785473 -0.822938078 -0.25725440 2 ## 89 -1.95315468 -0.477312882 -0.47498252 2 ## 90 -1.00151059 0.407240126 1.28196458 3 ## 91 -1.38867256 -1.124208098 -1.04216320 2 ## 92 -0.06154479 2.145985763 1.36590222 3 ## 93 -2.10578985 -2.154889064 -0.84274911 2 ## 94 -0.70534989 -0.773633422 -0.05626053 2 ## 95 0.38664628 0.823698255 1.80066167 3 ## 96 -0.84311220 -0.852899864 -0.48526559 2 ## 97 1.12126530 0.839356466 0.68300001 1 ## 98 0.26580966 0.120388613 -0.20406219 1 ## 99 0.08426394 -2.131598303 2.04037784 4 ## 100 1.05708187 -1.487982147 -1.28322415 1 3.3.1 Validación cluster La estructura de los cluster es aleatoria (¿funciona?) ¿Cómo definimos el valor de \\(K\\)? Silhouette coefficient: Se obtiene para la observación \\(i\\) el promedio de distancia a todos los objetos en el mismo cluster (\\(a_i\\)) Se obtiene para la observación \\(i\\) el promedio de distancia a todos los objetos de los otros clusters (\\(b_i\\)) Se define a \\(s_i\\) como el coeficiente, con un recorrido entre \\([-1,1]\\), para cada observación \\(i\\) \\[s_i=\\frac{b_i-a_i}{max(a_i,b_i)}\\] Idealmente se espera que \\(a_i &lt; b_i\\) y los \\(a_i\\) cercanos a \\(0\\). library(cluster) kk&lt;-kmeans(bd,3) s &lt;- silhouette(kk$cluster, dist(bd)) plot(s) #sobre la base IRIS data(&quot;iris&quot;) aux&lt;-kmeans(iris[,-5],3) s &lt;- silhouette(aux$cluster, dist(iris[,-5])) plot(s) Medoide: es el punto de datos que es “menos diferente” de todos los otros puntos de datos. A diferencia del centroide, el medoide tiene que ser uno de los puntos originales. pam(bd,k=3) ## Medoids: ## ID x y z ## [1,] 47 0.2649061 -0.1313135 -0.2513934 ## [2,] 58 -1.0232933 -0.6265213 -0.6783080 ## [3,] 75 0.1567753 0.7488960 0.6511574 ## Clustering vector: ## [1] 1 1 1 1 2 1 1 3 1 3 3 3 1 1 1 2 1 3 3 1 3 1 3 2 1 1 1 ## [28] 1 1 2 1 3 2 3 1 1 3 1 1 3 2 1 3 3 3 1 1 2 3 2 1 3 2 3 ## [55] 2 1 2 2 3 1 3 3 3 3 1 3 1 1 2 1 2 1 2 2 3 3 2 1 1 3 1 ## [82] 1 3 3 3 2 1 2 2 3 2 3 2 2 3 2 3 1 1 1 ## Objective function: ## build swap ## 1.203759 1.192385 ## ## Available components: ## [1] &quot;medoids&quot; &quot;id.med&quot; &quot;clustering&quot; &quot;objective&quot; ## [5] &quot;isolation&quot; &quot;clusinfo&quot; &quot;silinfo&quot; &quot;diss&quot; ## [9] &quot;call&quot; &quot;data&quot; kmeans(bd,3) ## K-means clustering with 3 clusters of sizes 32, 41, 27 ## ## Cluster means: ## x y z ## 1 -1.0335389 -0.4398382 -0.73643531 ## 2 0.4170795 0.9428450 0.04049812 ## 3 0.2946176 -0.7689965 0.59263802 ## ## Clustering vector: ## [1] 1 3 2 2 1 3 3 2 3 2 3 2 3 2 2 1 2 3 2 3 2 3 2 1 3 2 3 ## [28] 1 3 1 1 2 1 2 2 3 2 2 2 3 1 2 2 2 2 3 3 1 2 1 2 1 1 2 ## [55] 1 2 1 1 2 1 2 3 3 2 3 2 3 2 1 3 1 1 1 1 2 1 1 2 3 2 3 ## [82] 1 3 2 2 1 2 1 1 3 1 2 1 1 2 1 2 2 3 3 ## ## Within cluster sum of squares by cluster: ## [1] 50.68045 68.38983 37.72952 ## (between_SS / total_SS = 44.9 %) ## ## Available components: ## ## [1] &quot;cluster&quot; &quot;centers&quot; &quot;totss&quot; ## [4] &quot;withinss&quot; &quot;tot.withinss&quot; &quot;betweenss&quot; ## [7] &quot;size&quot; &quot;iter&quot; &quot;ifault&quot; ¿Cúal es el número óptimo de \\(k\\)? library(fpc)# Flexible Procedures for Clustering sol &lt;- pamk(iris[,-5], krange=2:10, criterion=&quot;asw&quot;, usepam=TRUE) sol ## $pamobject ## Medoids: ## ID Sepal.Length Sepal.Width Petal.Length Petal.Width ## [1,] 8 5.0 3.4 1.5 0.2 ## [2,] 127 6.2 2.8 4.8 1.8 ## Clustering vector: ## [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ## [28] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 ## [55] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 ## [82] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 2 2 2 2 2 2 2 2 2 ## [109] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 ## [136] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 ## Objective function: ## build swap ## 0.9901187 0.8622026 ## ## Available components: ## [1] &quot;medoids&quot; &quot;id.med&quot; &quot;clustering&quot; &quot;objective&quot; ## [5] &quot;isolation&quot; &quot;clusinfo&quot; &quot;silinfo&quot; &quot;diss&quot; ## [9] &quot;call&quot; &quot;data&quot; ## ## $nc ## [1] 2 ## ## $crit ## [1] 0.0000000 0.6857882 0.5528190 0.4896972 0.4867481 ## [6] 0.4703951 0.3390116 0.3318516 0.2918520 0.2918482 pamk(bd,krange=2:10,usepam = T) ## $pamobject ## Medoids: ## ID x y z ## [1,] 3 0.1246254 -0.001114346 -0.2009041 ## [2,] 78 1.3191613 0.201058067 -0.7087455 ## [3,] 96 -0.8431122 -0.852899864 -0.4852656 ## [4,] 46 0.1034892 -0.850940313 0.8789910 ## [5,] 45 -0.6303874 1.170041735 0.6953882 ## [6,] 49 0.8881742 0.846625398 0.6373557 ## [7,] 32 -0.3723337 1.691206328 -0.5559472 ## [8,] 71 -2.2403905 0.005047006 -2.0509972 ## Clustering vector: ## [1] 1 1 1 2 3 4 4 5 4 6 4 6 4 1 2 3 2 1 7 1 7 1 5 3 1 2 4 ## [28] 1 4 3 1 7 3 5 2 4 6 7 2 5 8 1 5 6 5 4 1 3 6 3 1 5 3 7 ## [55] 3 2 3 3 6 1 5 4 4 5 4 7 2 1 3 4 8 1 3 3 6 5 8 2 4 7 4 ## [82] 2 4 7 6 8 2 3 3 5 3 5 3 3 6 3 6 1 4 2 ## Objective function: ## build swap ## 0.8202221 0.7825730 ## ## Available components: ## [1] &quot;medoids&quot; &quot;id.med&quot; &quot;clustering&quot; &quot;objective&quot; ## [5] &quot;isolation&quot; &quot;clusinfo&quot; &quot;silinfo&quot; &quot;diss&quot; ## [9] &quot;call&quot; &quot;data&quot; ## ## $nc ## [1] 8 ## ## $crit ## [1] 0.0000000 0.2449526 0.2233785 0.2618319 0.2432127 ## [6] 0.2375996 0.2545661 0.2790932 0.2741168 0.2622158 3.3.2 Distancias para variables nominales (todas nominales) En este caso la mejor estrategia es llevar las variables con sus categorias a variables binarias. Existen múltiples medidas de distancia para variables binarias, muchas de estas medidas son aproximaciones a las medidas mas conocidas. Entre ellas: Sean las filas \\(i\\), \\(j\\) que contienen los valores binarios de las variables de estudio. Sea \\(A\\) el total de \\(1\\) que existe en \\(i\\), \\(B\\) el total de \\(1\\) que existe en \\(j\\) y sea \\(J\\) el total de casos en los que los \\(1\\) ocurren simultaneamente en \\(i\\) y \\(j\\). Euclideana \\[d_{ij}=\\sqrt{A+B-2J}\\] * Manhattan \\[d_{ij}=A+B-2J\\] * Bray \\[d_{ij}=\\frac{A+B-2J}{A+B}\\] Binomial \\[d_{ij}=log(2)(A+B-2J)\\] aux&lt;-rbind(c(0,0,0,0,1,1,1),c(1,0,1,0,0,1,1)) A&lt;-sum(aux[1,]) B&lt;-sum(aux[2,]) J&lt;-sum(apply(aux, 2, sum)==2) #euclideana sqrt(A+B-2*J) ## [1] 1.732051 #manhathan A+B-2*J ## [1] 3 #bray (A+B-2*J)/(A+B) ## [1] 0.4285714 #binomial log(2)*(A+B-2*J) ## [1] 2.079442 library(vegan) ## Loading required package: permute ## This is vegan 2.5-6 vegdist(aux,binary = T) ## 1 ## 2 0.4285714 vegdist(aux,binary = F) ## 1 ## 2 0.4285714 #una base de datos mas grandes set.seed(999) aux1&lt;-matrix(rbinom(200,1,0.4),nrow = 20) vegdist(aux1,method = &quot;binomial&quot;,binary = T) ## 1 2 3 4 5 ## 2 3.4657359 ## 3 3.4657359 2.7725887 ## 4 2.7725887 4.8520303 4.8520303 ## 5 4.1588831 3.4657359 4.8520303 2.7725887 ## 6 2.7725887 3.4657359 3.4657359 4.1588831 1.3862944 ## 7 3.4657359 2.7725887 2.7725887 2.0794415 3.4657359 ## 8 2.0794415 1.3862944 2.7725887 4.8520303 3.4657359 ## 9 2.7725887 3.4657359 4.8520303 4.1588831 2.7725887 ## 10 2.7725887 4.8520303 3.4657359 2.7725887 2.7725887 ## 11 3.4657359 2.7725887 4.1588831 3.4657359 4.8520303 ## 12 2.7725887 4.8520303 3.4657359 2.7725887 4.1588831 ## 13 4.1588831 4.8520303 3.4657359 2.7725887 2.7725887 ## 14 4.8520303 4.1588831 4.1588831 3.4657359 3.4657359 ## 15 1.3862944 3.4657359 2.0794415 2.7725887 4.1588831 ## 16 3.4657359 4.1588831 5.5451774 2.0794415 0.6931472 ## 17 3.4657359 2.7725887 4.1588831 3.4657359 3.4657359 ## 18 2.7725887 4.8520303 3.4657359 4.1588831 4.1588831 ## 19 3.4657359 4.1588831 1.3862944 4.8520303 3.4657359 ## 20 4.8520303 2.7725887 4.1588831 3.4657359 3.4657359 ## 6 7 8 9 10 ## 2 ## 3 ## 4 ## 5 ## 6 ## 7 4.8520303 ## 8 2.0794415 4.1588831 ## 9 1.3862944 6.2383246 2.0794415 ## 10 2.7725887 3.4657359 3.4657359 2.7725887 ## 11 4.8520303 2.7725887 4.1588831 3.4657359 3.4657359 ## 12 2.7725887 3.4657359 4.8520303 2.7725887 2.7725887 ## 13 2.7725887 4.8520303 4.8520303 2.7725887 2.7725887 ## 14 3.4657359 4.1588831 4.1588831 2.0794415 2.0794415 ## 15 2.7725887 3.4657359 2.0794415 2.7725887 1.3862944 ## 16 2.0794415 4.1588831 4.1588831 2.0794415 2.0794415 ## 17 3.4657359 5.5451774 2.7725887 2.0794415 4.8520303 ## 18 4.1588831 3.4657359 4.8520303 4.1588831 2.7725887 ## 19 2.0794415 4.1588831 2.7725887 3.4657359 2.0794415 ## 20 3.4657359 4.1588831 4.1588831 2.0794415 3.4657359 ## 11 12 13 14 15 ## 2 ## 3 ## 4 ## 5 ## 6 ## 7 ## 8 ## 9 ## 10 ## 11 ## 12 2.0794415 ## 13 3.4657359 2.7725887 ## 14 2.7725887 2.0794415 3.4657359 ## 15 3.4657359 2.7725887 2.7725887 3.4657359 ## 16 4.1588831 3.4657359 2.0794415 2.7725887 3.4657359 ## 17 4.1588831 4.8520303 2.0794415 4.1588831 3.4657359 ## 18 3.4657359 2.7725887 4.1588831 3.4657359 4.1588831 ## 19 4.1588831 3.4657359 2.0794415 4.1588831 2.0794415 ## 20 1.3862944 2.0794415 2.0794415 1.3862944 3.4657359 ## 16 17 18 19 ## 2 ## 3 ## 4 ## 5 ## 6 ## 7 ## 8 ## 9 ## 10 ## 11 ## 12 ## 13 ## 14 ## 15 ## 16 ## 17 2.7725887 ## 18 3.4657359 4.8520303 ## 19 4.1588831 4.1588831 3.4657359 ## 20 2.7725887 2.7725887 4.8520303 4.1588831 dist(aux1) ## 1 2 3 4 5 6 ## 2 2.236068 ## 3 2.236068 2.000000 ## 4 2.000000 2.645751 2.645751 ## 5 2.449490 2.236068 2.645751 2.000000 ## 6 2.000000 2.236068 2.236068 2.449490 1.414214 ## 7 2.236068 2.000000 2.000000 1.732051 2.236068 2.645751 ## 8 1.732051 1.414214 2.000000 2.645751 2.236068 1.732051 ## 9 2.000000 2.236068 2.645751 2.449490 2.000000 1.414214 ## 10 2.000000 2.645751 2.236068 2.000000 2.000000 2.000000 ## 11 2.236068 2.000000 2.449490 2.236068 2.645751 2.645751 ## 12 2.000000 2.645751 2.236068 2.000000 2.449490 2.000000 ## 13 2.449490 2.645751 2.236068 2.000000 2.000000 2.000000 ## 14 2.645751 2.449490 2.449490 2.236068 2.236068 2.236068 ## 15 1.414214 2.236068 1.732051 2.000000 2.449490 2.000000 ## 16 2.236068 2.449490 2.828427 1.732051 1.000000 1.732051 ## 17 2.236068 2.000000 2.449490 2.236068 2.236068 2.236068 ## 18 2.000000 2.645751 2.236068 2.449490 2.449490 2.449490 ## 19 2.236068 2.449490 1.414214 2.645751 2.236068 1.732051 ## 20 2.645751 2.000000 2.449490 2.236068 2.236068 2.236068 ## 7 8 9 10 11 12 ## 2 ## 3 ## 4 ## 5 ## 6 ## 7 ## 8 2.449490 ## 9 3.000000 1.732051 ## 10 2.236068 2.236068 2.000000 ## 11 2.000000 2.449490 2.236068 2.236068 ## 12 2.236068 2.645751 2.000000 2.000000 1.732051 ## 13 2.645751 2.645751 2.000000 2.000000 2.236068 2.000000 ## 14 2.449490 2.449490 1.732051 1.732051 2.000000 1.732051 ## 15 2.236068 1.732051 2.000000 1.414214 2.236068 2.000000 ## 16 2.449490 2.449490 1.732051 1.732051 2.449490 2.236068 ## 17 2.828427 2.000000 1.732051 2.645751 2.449490 2.645751 ## 18 2.236068 2.645751 2.449490 2.000000 2.236068 2.000000 ## 19 2.449490 2.000000 2.236068 1.732051 2.449490 2.236068 ## 20 2.449490 2.449490 1.732051 2.236068 1.414214 1.732051 ## 13 14 15 16 17 18 ## 2 ## 3 ## 4 ## 5 ## 6 ## 7 ## 8 ## 9 ## 10 ## 11 ## 12 ## 13 ## 14 2.236068 ## 15 2.000000 2.236068 ## 16 1.732051 2.000000 2.236068 ## 17 1.732051 2.449490 2.236068 2.000000 ## 18 2.449490 2.236068 2.449490 2.236068 2.645751 ## 19 1.732051 2.449490 1.732051 2.449490 2.449490 2.236068 ## 20 1.732051 1.414214 2.236068 2.000000 2.000000 2.645751 ## 19 ## 2 ## 3 ## 4 ## 5 ## 6 ## 7 ## 8 ## 9 ## 10 ## 11 ## 12 ## 13 ## 14 ## 15 ## 16 ## 17 ## 18 ## 19 ## 20 2.449490 3.3.3 Distancias para variables mixtas (cuantitativas, nominales, ordinales) library(cluster) data(&quot;flower&quot;) str(flower) ## &#39;data.frame&#39;: 18 obs. of 8 variables: ## $ V1: Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 2 1 1 1 1 1 1 2 2 ... ## $ V2: Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 1 2 1 2 2 1 1 2 2 ... ## $ V3: Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 1 1 2 1 1 1 2 1 1 ... ## $ V4: Factor w/ 5 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 4 2 3 4 5 4 4 2 3 5 ... ## $ V5: Ord.factor w/ 3 levels &quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;: 3 1 3 2 2 3 3 2 1 2 ... ## $ V6: Ord.factor w/ 18 levels &quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;&lt;&quot;4&quot;&lt;..: 15 3 1 16 2 12 13 7 4 14 ... ## $ V7: num 25 150 150 125 20 50 40 100 25 100 ... ## $ V8: num 15 50 50 50 15 40 20 15 15 60 ... dd&lt;-daisy(flower,metric = &quot;gower&quot;) summary(dd) ## 153 dissimilarities, summarized : ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0.1418 0.3904 0.4829 0.4865 0.5865 0.8875 ## Metric : mixed ; Types = N, N, N, N, O, O, I, I ## Number of objects : 18 Ejercicios Busque funciones en R que permitan calcular los k-center para variables mixtas y medoides Crear una función k-center para variables mixtas y alternativas para incluir el medoide. 3.4 Cluster Jerárquico El objetivo es obtener una jerarquía de posibles soluciones que van desde un solo grupo a \\(n\\) grupos, donde \\(n\\) es el número de observaciones en el conjunto de datos. 3.4.1 Algoritmo (Johnson) Se inicia con \\(n\\) grupos y se genera una matriz de \\(nxn\\) de distancias, \\(D=\\{d_{ik}\\}\\) Buscar en la matriz de distancia los pares de cluster más cercanos entre ellos, “los cluster mas similares”, si defifinimos los clusters \\(V\\) y \\(U\\), estamos interesados en encontrar \\(d_{UV}\\) Unir los cluster \\(U\\) y \\(V\\), re etiquetar el nuevo cluster como \\(UV\\). Actualizar la matriz de distancias a) remover las filas y columnas correspondientes a \\(U\\) y \\(V\\) b) incluimos las nuevas filas y columnas para el nuevo cluster \\(UV\\). Repetimos el paso 2 y 3 un total de \\(n-1\\) veces. El momento de definir el cluster más cercano, se puede emplear los siguientes enlaces: Single linkage (Enlace simple): Se elige al cluster más cercano, con la regla de que las distincia individual entre las observaciones dentro de los clusters es la más corta Complete linkage (Enlace completo): Se elige el cluster mas cercano, con la regla que las distnaicas individuales entre las observaciones dentro de los cluster es la más larga Average linkage (Enlace promedio): Se elige el cluster mas cercano, considerando el promedio de las distancias entre los cluster. Nota: Se debe elegir la matriz de distancias acorde a la naturaleza de los datos, se recomienda: Todas Numéricas: Euclideana o Manhatan Todas nominales: Transformación a binarias y usar la distancia binomial Mixtas: Distancia de Gower d &lt;- dist(scale(iris[,-5]))#euclideana h &lt;- hclust(d) plot(h,hang=-0.1,labels=iris[[&quot;Species&quot;]],cex=0.5) #elegir la cantidad de grupos clus3 &lt;- cutree(h, 5) plot(h,hang=-0.1,labels=iris[[&quot;Species&quot;]],cex=0.5) rect.hclust(h,k=5) Probando los tres tipos de enlaces para \\(k=3\\) hs &lt;- hclust(d,method = &quot;single&quot;) hc &lt;- hclust(d,method = &quot;complete&quot;) ha &lt;- hclust(d,method = &quot;average&quot;) cs&lt;-cutree(hs,3) cc&lt;-cutree(hc,3) ca&lt;-cutree(ha,3) table(cs,cc) ## cc ## cs 1 2 3 ## 1 49 0 0 ## 2 0 1 0 ## 3 0 23 77 table(cs,ca) ## ca ## cs 1 2 3 ## 1 49 0 0 ## 2 1 0 0 ## 3 0 97 3 table(cc,ca) ## ca ## cc 1 2 3 ## 1 49 0 0 ## 2 1 23 0 ## 3 0 74 3 par(mfrow=c(1,3)) plot(hs,hang=-0.1,labels=iris[[&quot;Species&quot;]],cex=0.5) rect.hclust(hs,k=3) plot(hc,hang=-0.1,labels=iris[[&quot;Species&quot;]],cex=0.5) rect.hclust(hc,k=3) plot(ha,hang=-0.1,labels=iris[[&quot;Species&quot;]],cex=0.5) rect.hclust(ha,k=3) Nota: El dendograma es muy útil para ver las relaciones que existen basadas en las distancias y la creación de las jerarquias, a partir de estos se puede definir un \\(k\\) (de forma visual) Nota: El dendograma pierde su utilidad cuando la cantidad de observaciones es muy alta, Ejemplo, Usar los datos de las elecciones del 20 de octubre, agregar los resultados en términos relativos para los municipios y generar el dendograma para los tres tipos de enlaces, de forma visual sugerir un valor de \\(k\\) para cada tipo de enlace. library(dplyr) load(&quot;C:\\\\Users\\\\ALVARO\\\\Documents\\\\GitHub\\\\EST-384\\\\data\\\\oct20.RData&quot;) #filtrar los casos aux&lt;-c(&quot;Número departamento&quot;,&quot;Departamento&quot; ,&quot;Número municipio&quot;,&quot;Municipio&quot; ,&quot;CC&quot;,&quot;FPV&quot;,&quot;MTS&quot;,&quot;UCS&quot;,&quot;MAS - IPSP&quot;,&quot;21F&quot;,&quot;PDC&quot;,&quot;MNR&quot;,&quot;PAN-BOL&quot;,&quot;Votos Válidos&quot;,&quot;Blancos&quot;,&quot;Nulos&quot;) names(computo)[1]&lt;-&quot;pais&quot; names(computo)[12]&lt;-&quot;eleccion&quot; bd&lt;-computo %&gt;% filter(pais==&quot;Bolivia&quot; &amp; eleccion==&quot;Presidente y Vicepresidente&quot;) %&gt;% select(aux) names(bd)[1:4]&lt;-c(&quot;idep&quot;,&quot;ddep&quot;,&quot;imun&quot;,&quot;dmun&quot;) bdmun&lt;-aggregate(bd[,5:16],bd[,1:4],sum) bdmun&lt;-bdmun[,-14] bdmun[,5:15]&lt;-prop.table(as.matrix(bdmun[,5:15]),1) #cluster jerarquico d&lt;-dist(bdmun[,5:15]) plot(hclust(d),hang=-0.1,label=bdmun$dmun,cex=0.5) # determinar el mejor k y el mejor enlace mm&lt;-c(&quot;single&quot;, &quot;complete&quot;, &quot;average&quot;) # método k&lt;-2:20 # cantidad de cluster d&lt;-dist(bdmun[,5:15]) # matriz de distancia # matriz de resultados res&lt;-matrix(NA, nrow = 19,ncol=3) colnames(res)&lt;-mm rownames(res)&lt;-k ####################### for(i in k){ for(j in 1:3){ h&lt;-hclust(d,method = mm[j]) c&lt;-cutree(h,i) s&lt;-silhouette(c,d) res[i-1,j]&lt;-median(s[,3]) } } #la mejor opción es k=2 con el método average h&lt;-hclust(d,method = &quot;average&quot;) c&lt;-cutree(h,2) plot(h,hang=-0.1,labels=bdmun$dmun,cex=0.4) rect.hclust(h,k=2) bdmun$cluster&lt;-c group_by(bdmun,cluster) %&gt;% summarise(mean(CC),mean(`MAS - IPSP`)) Algunas alternativas para la visualización son: library(ape) h$labels&lt;-bdmun$dmun plot(as.phylo(h),type=&quot;fan&quot;) library(dendextend) library(circlize) dend &lt;- as.dendrogram(h) # modify the dendrogram to have some colors in the branches and labels dend &lt;- dend %&gt;% color_branches(k=4) %&gt;% color_labels # plot the radial plot png(&quot;dendo.png&quot;,width = 1500,height = 1500) par(mar = rep(0,4)) # circlize_dendrogram(dend, ) circlize_dendrogram(dend,dend_track_height = 0.8) dev.off() 3.5 Ejercicios Pensar en un gráfico que permita ver como se asignaron los cluster Pensar en optimizar el código empleado para el k-center Hacer que la función desarrollada para el k-center retorne también los centroides Utilizando la base de datos de las elecciones del 20 de octubre, crear una base de datos a nivel municipal, aplicar el método k-center con medoides para los resultados a nivel municipal y terminar el \\(k\\) óptimo en un rango de \\(k=2:10\\) (Usar datos relativos). "],
["regresión.html", "4 Regresión 4.1 Regresión lineal 4.2 Probit y Logit", " 4 Regresión \\[y=f(x_1,x_2, \\ldots)\\] \\(y\\) Variable de resultado, dependiente, solo tenemos a una \\(y\\). \\(x_1, x_2, \\ldots\\), variables de control, independientes. A partir de estas variables: ¿Cuál es la relación de \\(x\\) sobre \\(y\\)? Lineal \\[y_i=\\beta_0+\\beta_1 x_1+\\beta_2x_2+\\ldots+\\epsilon_i\\] &gt; Nota: Diferenciar que la regresión busca establacer relaciones basadas en los datos y no asi un proceso causal. + Polinomial + Etc; No lineal, Conocer la naturaleza de \\(y\\) y las variables \\(x\\) \\(Y\\) es cuanti (real), \\(X\\) cuanti. \\(Y\\) es cuanti (discreta &gt;= 0), \\(X\\) cuanti. \\(Y\\) es cuali nominal binario, \\(X\\) mixtas. \\(Y\\) es cuali ordinal, \\(X\\) mixtas. 4.1 Regresión lineal 4.1.1 Paso 1: Base de datos library(dplyr) load(&quot;C:\\\\Users\\\\ALVARO\\\\Documents\\\\GitHub\\\\EST-384\\\\data\\\\eh18.Rdata&quot;) bd&lt;-eh18p %&gt;% filter(s02a_03&gt;=18 &amp; s02a_05==&quot;1.JEFE O JEFA DEL HOGAR&quot; &amp; ocupado==&quot;Si&quot;) %&gt;% select(s02a_02,s02a_03,aestudio,tothrs,ylab,ynolab,factor,estrato, upm,area,permanente,cob_op) 4.1.2 Paso 2: Establecer la relación de interés. \\(Y\\) Ingreso laboral puede ser un buena opción \\(X\\) el resto, pueden ser basadas en un modelo teórico o buscadas a partir de un proceso de minería de datos \\[IngresoLaboral=f(edad,sexo,educación,...)\\] 4.1.3 Paso 3: Definir el modelo a utilizar OLS, MCO. Modelos lineales m1&lt;-lm(ylab~s02a_03,data=bd)# regresión lineal simple y=f(x) m1 ## ## Call: ## lm(formula = ylab ~ s02a_03, data = bd) ## ## Coefficients: ## (Intercept) s02a_03 ## 4112.16 -21.84 \\[ylab_i=\\beta_0+\\beta_1edad_i+\\epsilon_i\\] \\[E[ylab_i]=4112.16-21.84*edad_i\\] plot(bd$s02a_03,bd$ylab) abline(m1,col=&quot;red&quot;,lwd=2) summary(m1) ## ## Call: ## lm(formula = ylab ~ s02a_03, data = bd) ## ## Residuals: ## Min 1Q Median 3Q Max ## -3505 -1545 -482 876 33548 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 4112.155 81.267 50.60 &lt;2e-16 *** ## s02a_03 -21.841 1.744 -12.52 &lt;2e-16 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 2380 on 9296 degrees of freedom ## (118 observations deleted due to missingness) ## Multiple R-squared: 0.01659, Adjusted R-squared: 0.01649 ## F-statistic: 156.8 on 1 and 9296 DF, p-value: &lt; 2.2e-16 #en los betas coefficients(m1) ## (Intercept) s02a_03 ## 4112.1555 -21.8413 confint(m1,level=0.99) ## 0.5 % 99.5 % ## (Intercept) 3902.7837 4321.527 ## s02a_03 -26.3346 -17.348 #mejorar el modelo m2&lt;-lm(ylab~s02a_03+aestudio+tothrs+ynolab+s02a_02+area+cob_op,data=bd) summary(m2) ## ## Call: ## lm(formula = ylab ~ s02a_03 + aestudio + tothrs + ynolab + s02a_02 + ## area + cob_op, data = bd) ## ## Residuals: ## Min 1Q Median 3Q Max ## -5808.3 -1100.1 -325.8 641.1 30954.9 ## ## Coefficients: ## Estimate ## (Intercept) 4.576e+03 ## s02a_03 2.609e+00 ## aestudio 7.101e+01 ## tothrs 1.681e+01 ## ynolab 2.201e-02 ## s02a_022.Mujer -7.252e+02 ## areaRural -4.366e+02 ## cob_opDirectivos Adm. Pública y Empresas 5.826e+01 ## cob_opProfesionales cientificos e intelectuales -9.262e+02 ## cob_opTécnicos de Nivel Medio -2.022e+03 ## cob_opEmpleados de oficina -2.561e+03 ## cob_opTrabajadores de Servicio y Vendedores -2.913e+03 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros -4.003e+03 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros -2.971e+03 ## cob_opOperadores de Instalaciones y Maquinarias -2.547e+03 ## cob_opTrabajadores No Calificados -3.238e+03 ## Std. Error ## (Intercept) 3.832e+02 ## s02a_03 1.651e+00 ## aestudio 5.753e+00 ## tothrs 1.229e+00 ## ynolab 2.574e-02 ## s02a_022.Mujer 5.468e+01 ## areaRural 6.572e+01 ## cob_opDirectivos Adm. Pública y Empresas 3.750e+02 ## cob_opProfesionales cientificos e intelectuales 3.588e+02 ## cob_opTécnicos de Nivel Medio 3.618e+02 ## cob_opEmpleados de oficina 3.783e+02 ## cob_opTrabajadores de Servicio y Vendedores 3.580e+02 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros 3.625e+02 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros 3.566e+02 ## cob_opOperadores de Instalaciones y Maquinarias 3.578e+02 ## cob_opTrabajadores No Calificados 3.639e+02 ## t value ## (Intercept) 11.942 ## s02a_03 1.580 ## aestudio 12.343 ## tothrs 13.674 ## ynolab 0.855 ## s02a_022.Mujer -13.263 ## areaRural -6.644 ## cob_opDirectivos Adm. Pública y Empresas 0.155 ## cob_opProfesionales cientificos e intelectuales -2.581 ## cob_opTécnicos de Nivel Medio -5.590 ## cob_opEmpleados de oficina -6.768 ## cob_opTrabajadores de Servicio y Vendedores -8.135 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros -11.043 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros -8.331 ## cob_opOperadores de Instalaciones y Maquinarias -7.119 ## cob_opTrabajadores No Calificados -8.898 ## Pr(&gt;|t|) ## (Intercept) &lt; 2e-16 ## s02a_03 0.11419 ## aestudio &lt; 2e-16 ## tothrs &lt; 2e-16 ## ynolab 0.39260 ## s02a_022.Mujer &lt; 2e-16 ## areaRural 3.22e-11 ## cob_opDirectivos Adm. Pública y Empresas 0.87655 ## cob_opProfesionales cientificos e intelectuales 0.00987 ## cob_opTécnicos de Nivel Medio 2.34e-08 ## cob_opEmpleados de oficina 1.38e-11 ## cob_opTrabajadores de Servicio y Vendedores 4.65e-16 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros &lt; 2e-16 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros &lt; 2e-16 ## cob_opOperadores de Instalaciones y Maquinarias 1.17e-12 ## cob_opTrabajadores No Calificados &lt; 2e-16 ## ## (Intercept) *** ## s02a_03 ## aestudio *** ## tothrs *** ## ynolab ## s02a_022.Mujer *** ## areaRural *** ## cob_opDirectivos Adm. Pública y Empresas ## cob_opProfesionales cientificos e intelectuales ** ## cob_opTécnicos de Nivel Medio *** ## cob_opEmpleados de oficina *** ## cob_opTrabajadores de Servicio y Vendedores *** ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros *** ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros *** ## cob_opOperadores de Instalaciones y Maquinarias *** ## cob_opTrabajadores No Calificados *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 1988 on 9278 degrees of freedom ## (122 observations deleted due to missingness) ## Multiple R-squared: 0.3154, Adjusted R-squared: 0.3143 ## F-statistic: 284.9 on 15 and 9278 DF, p-value: &lt; 2.2e-16 m3&lt;-lm(log(ylab)~s02a_03+aestudio+tothrs+ynolab+s02a_02+area+cob_op,data=bd) summary(m3) ## ## Call: ## lm(formula = log(ylab) ~ s02a_03 + aestudio + tothrs + ynolab + ## s02a_02 + area + cob_op, data = bd) ## ## Residuals: ## Min 1Q Median 3Q Max ## -5.0630 -0.3653 0.0333 0.4194 2.9355 ## ## Coefficients: ## Estimate ## (Intercept) 8.233e+00 ## s02a_03 -8.120e-03 ## aestudio 2.595e-02 ## tothrs 8.519e-03 ## ynolab -2.026e-05 ## s02a_022.Mujer -3.486e-01 ## areaRural -2.821e-01 ## cob_opDirectivos Adm. Pública y Empresas 4.002e-02 ## cob_opProfesionales cientificos e intelectuales -9.679e-03 ## cob_opTécnicos de Nivel Medio -3.748e-01 ## cob_opEmpleados de oficina -4.541e-01 ## cob_opTrabajadores de Servicio y Vendedores -6.190e-01 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros -1.428e+00 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros -6.004e-01 ## cob_opOperadores de Instalaciones y Maquinarias -4.837e-01 ## cob_opTrabajadores No Calificados -7.000e-01 ## Std. Error ## (Intercept) 1.384e-01 ## s02a_03 5.962e-04 ## aestudio 2.077e-03 ## tothrs 4.437e-04 ## ynolab 9.295e-06 ## s02a_022.Mujer 1.974e-02 ## areaRural 2.373e-02 ## cob_opDirectivos Adm. Pública y Empresas 1.354e-01 ## cob_opProfesionales cientificos e intelectuales 1.296e-01 ## cob_opTécnicos de Nivel Medio 1.306e-01 ## cob_opEmpleados de oficina 1.366e-01 ## cob_opTrabajadores de Servicio y Vendedores 1.293e-01 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros 1.309e-01 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros 1.288e-01 ## cob_opOperadores de Instalaciones y Maquinarias 1.292e-01 ## cob_opTrabajadores No Calificados 1.314e-01 ## t value ## (Intercept) 59.505 ## s02a_03 -13.620 ## aestudio 12.491 ## tothrs 19.198 ## ynolab -2.180 ## s02a_022.Mujer -17.656 ## areaRural -11.891 ## cob_opDirectivos Adm. Pública y Empresas 0.296 ## cob_opProfesionales cientificos e intelectuales -0.075 ## cob_opTécnicos de Nivel Medio -2.870 ## cob_opEmpleados de oficina -3.324 ## cob_opTrabajadores de Servicio y Vendedores -4.789 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros -10.910 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros -4.663 ## cob_opOperadores de Instalaciones y Maquinarias -3.744 ## cob_opTrabajadores No Calificados -5.327 ## Pr(&gt;|t|) ## (Intercept) &lt; 2e-16 ## s02a_03 &lt; 2e-16 ## aestudio &lt; 2e-16 ## tothrs &lt; 2e-16 ## ynolab 0.029280 ## s02a_022.Mujer &lt; 2e-16 ## areaRural &lt; 2e-16 ## cob_opDirectivos Adm. Pública y Empresas 0.767563 ## cob_opProfesionales cientificos e intelectuales 0.940448 ## cob_opTécnicos de Nivel Medio 0.004116 ## cob_opEmpleados de oficina 0.000890 ## cob_opTrabajadores de Servicio y Vendedores 1.71e-06 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros &lt; 2e-16 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros 3.16e-06 ## cob_opOperadores de Instalaciones y Maquinarias 0.000182 ## cob_opTrabajadores No Calificados 1.02e-07 ## ## (Intercept) *** ## s02a_03 *** ## aestudio *** ## tothrs *** ## ynolab * ## s02a_022.Mujer *** ## areaRural *** ## cob_opDirectivos Adm. Pública y Empresas ## cob_opProfesionales cientificos e intelectuales ## cob_opTécnicos de Nivel Medio ** ## cob_opEmpleados de oficina *** ## cob_opTrabajadores de Servicio y Vendedores *** ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros *** ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros *** ## cob_opOperadores de Instalaciones y Maquinarias *** ## cob_opTrabajadores No Calificados *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.7177 on 9278 degrees of freedom ## (122 observations deleted due to missingness) ## Multiple R-squared: 0.4648, Adjusted R-squared: 0.4639 ## F-statistic: 537.1 on 15 and 9278 DF, p-value: &lt; 2.2e-16 m4&lt;-lm(log(ylab)~s02a_03+factor(aestudio)+tothrs+ynolab+s02a_02+area+cob_op,data=bd) summary(m4) ## ## Call: ## lm(formula = log(ylab) ~ s02a_03 + factor(aestudio) + tothrs + ## ynolab + s02a_02 + area + cob_op, data = bd) ## ## Residuals: ## Min 1Q Median 3Q Max ## -4.7206 -0.3539 0.0312 0.4048 3.1249 ## ## Coefficients: ## Estimate ## (Intercept) 7.820e+00 ## s02a_03 -7.844e-03 ## factor(aestudio)1 3.339e-01 ## factor(aestudio)2 4.623e-01 ## factor(aestudio)3 4.087e-01 ## factor(aestudio)4 4.968e-01 ## factor(aestudio)5 5.998e-01 ## factor(aestudio)6 5.960e-01 ## factor(aestudio)7 7.228e-01 ## factor(aestudio)8 6.500e-01 ## factor(aestudio)9 5.755e-01 ## factor(aestudio)10 6.404e-01 ## factor(aestudio)11 5.875e-01 ## factor(aestudio)12 6.286e-01 ## factor(aestudio)13 4.730e-01 ## factor(aestudio)14 6.351e-01 ## factor(aestudio)15 6.638e-01 ## factor(aestudio)16 7.217e-01 ## factor(aestudio)17 8.747e-01 ## factor(aestudio)18 1.006e+00 ## factor(aestudio)19 1.167e+00 ## factor(aestudio)22 1.173e+00 ## tothrs 8.296e-03 ## ynolab -2.202e-05 ## s02a_022.Mujer -3.238e-01 ## areaRural -2.754e-01 ## cob_opDirectivos Adm. Pública y Empresas 4.876e-02 ## cob_opProfesionales cientificos e intelectuales -5.148e-02 ## cob_opTécnicos de Nivel Medio -3.047e-01 ## cob_opEmpleados de oficina -4.010e-01 ## cob_opTrabajadores de Servicio y Vendedores -5.664e-01 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros -1.369e+00 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros -5.489e-01 ## cob_opOperadores de Instalaciones y Maquinarias -4.296e-01 ## cob_opTrabajadores No Calificados -6.543e-01 ## Std. Error ## (Intercept) 1.424e-01 ## s02a_03 6.022e-04 ## factor(aestudio)1 6.822e-02 ## factor(aestudio)2 5.362e-02 ## factor(aestudio)3 4.965e-02 ## factor(aestudio)4 5.229e-02 ## factor(aestudio)5 4.685e-02 ## factor(aestudio)6 5.512e-02 ## factor(aestudio)7 6.277e-02 ## factor(aestudio)8 5.242e-02 ## factor(aestudio)9 5.924e-02 ## factor(aestudio)10 5.537e-02 ## factor(aestudio)11 5.515e-02 ## factor(aestudio)12 4.530e-02 ## factor(aestudio)13 7.556e-02 ## factor(aestudio)14 6.006e-02 ## factor(aestudio)15 5.741e-02 ## factor(aestudio)16 6.873e-02 ## factor(aestudio)17 5.384e-02 ## factor(aestudio)18 9.785e-02 ## factor(aestudio)19 1.039e-01 ## factor(aestudio)22 3.228e-01 ## tothrs 4.409e-04 ## ynolab 9.220e-06 ## s02a_022.Mujer 1.975e-02 ## areaRural 2.356e-02 ## cob_opDirectivos Adm. Pública y Empresas 1.346e-01 ## cob_opProfesionales cientificos e intelectuales 1.287e-01 ## cob_opTécnicos de Nivel Medio 1.305e-01 ## cob_opEmpleados de oficina 1.362e-01 ## cob_opTrabajadores de Servicio y Vendedores 1.299e-01 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros 1.314e-01 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros 1.296e-01 ## cob_opOperadores de Instalaciones y Maquinarias 1.301e-01 ## cob_opTrabajadores No Calificados 1.322e-01 ## t value ## (Intercept) 54.901 ## s02a_03 -13.026 ## factor(aestudio)1 4.894 ## factor(aestudio)2 8.621 ## factor(aestudio)3 8.232 ## factor(aestudio)4 9.500 ## factor(aestudio)5 12.802 ## factor(aestudio)6 10.812 ## factor(aestudio)7 11.515 ## factor(aestudio)8 12.401 ## factor(aestudio)9 9.715 ## factor(aestudio)10 11.565 ## factor(aestudio)11 10.653 ## factor(aestudio)12 13.877 ## factor(aestudio)13 6.261 ## factor(aestudio)14 10.575 ## factor(aestudio)15 11.562 ## factor(aestudio)16 10.500 ## factor(aestudio)17 16.247 ## factor(aestudio)18 10.285 ## factor(aestudio)19 11.226 ## factor(aestudio)22 3.634 ## tothrs 18.817 ## ynolab -2.388 ## s02a_022.Mujer -16.399 ## areaRural -11.690 ## cob_opDirectivos Adm. Pública y Empresas 0.362 ## cob_opProfesionales cientificos e intelectuales -0.400 ## cob_opTécnicos de Nivel Medio -2.335 ## cob_opEmpleados de oficina -2.943 ## cob_opTrabajadores de Servicio y Vendedores -4.360 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros -10.421 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros -4.234 ## cob_opOperadores de Instalaciones y Maquinarias -3.303 ## cob_opTrabajadores No Calificados -4.951 ## Pr(&gt;|t|) ## (Intercept) &lt; 2e-16 ## s02a_03 &lt; 2e-16 ## factor(aestudio)1 1.00e-06 ## factor(aestudio)2 &lt; 2e-16 ## factor(aestudio)3 &lt; 2e-16 ## factor(aestudio)4 &lt; 2e-16 ## factor(aestudio)5 &lt; 2e-16 ## factor(aestudio)6 &lt; 2e-16 ## factor(aestudio)7 &lt; 2e-16 ## factor(aestudio)8 &lt; 2e-16 ## factor(aestudio)9 &lt; 2e-16 ## factor(aestudio)10 &lt; 2e-16 ## factor(aestudio)11 &lt; 2e-16 ## factor(aestudio)12 &lt; 2e-16 ## factor(aestudio)13 4.01e-10 ## factor(aestudio)14 &lt; 2e-16 ## factor(aestudio)15 &lt; 2e-16 ## factor(aestudio)16 &lt; 2e-16 ## factor(aestudio)17 &lt; 2e-16 ## factor(aestudio)18 &lt; 2e-16 ## factor(aestudio)19 &lt; 2e-16 ## factor(aestudio)22 0.000280 ## tothrs &lt; 2e-16 ## ynolab 0.016945 ## s02a_022.Mujer &lt; 2e-16 ## areaRural &lt; 2e-16 ## cob_opDirectivos Adm. Pública y Empresas 0.717174 ## cob_opProfesionales cientificos e intelectuales 0.689269 ## cob_opTécnicos de Nivel Medio 0.019552 ## cob_opEmpleados de oficina 0.003254 ## cob_opTrabajadores de Servicio y Vendedores 1.31e-05 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros &lt; 2e-16 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros 2.32e-05 ## cob_opOperadores de Instalaciones y Maquinarias 0.000959 ## cob_opTrabajadores No Calificados 7.53e-07 ## ## (Intercept) *** ## s02a_03 *** ## factor(aestudio)1 *** ## factor(aestudio)2 *** ## factor(aestudio)3 *** ## factor(aestudio)4 *** ## factor(aestudio)5 *** ## factor(aestudio)6 *** ## factor(aestudio)7 *** ## factor(aestudio)8 *** ## factor(aestudio)9 *** ## factor(aestudio)10 *** ## factor(aestudio)11 *** ## factor(aestudio)12 *** ## factor(aestudio)13 *** ## factor(aestudio)14 *** ## factor(aestudio)15 *** ## factor(aestudio)16 *** ## factor(aestudio)17 *** ## factor(aestudio)18 *** ## factor(aestudio)19 *** ## factor(aestudio)22 *** ## tothrs *** ## ynolab * ## s02a_022.Mujer *** ## areaRural *** ## cob_opDirectivos Adm. Pública y Empresas ## cob_opProfesionales cientificos e intelectuales ## cob_opTécnicos de Nivel Medio * ## cob_opEmpleados de oficina ** ## cob_opTrabajadores de Servicio y Vendedores *** ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros *** ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros *** ## cob_opOperadores de Instalaciones y Maquinarias *** ## cob_opTrabajadores No Calificados *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.7112 on 9259 degrees of freedom ## (122 observations deleted due to missingness) ## Multiple R-squared: 0.4756, Adjusted R-squared: 0.4736 ## F-statistic: 246.9 on 34 and 9259 DF, p-value: &lt; 2.2e-16 4.1.4 Paso 4: Optimizar el modelo m5&lt;-lm(log(ylab)~.,data=bd[,-c(7,8,9,11)]) summary(m5) ## ## Call: ## lm(formula = log(ylab) ~ ., data = bd[, -c(7, 8, 9, 11)]) ## ## Residuals: ## Min 1Q Median 3Q Max ## -5.0630 -0.3653 0.0333 0.4194 2.9355 ## ## Coefficients: ## Estimate ## (Intercept) 8.233e+00 ## s02a_022.Mujer -3.486e-01 ## s02a_03 -8.120e-03 ## aestudio 2.595e-02 ## tothrs 8.519e-03 ## ynolab -2.026e-05 ## areaRural -2.821e-01 ## cob_opDirectivos Adm. Pública y Empresas 4.002e-02 ## cob_opProfesionales cientificos e intelectuales -9.679e-03 ## cob_opTécnicos de Nivel Medio -3.748e-01 ## cob_opEmpleados de oficina -4.541e-01 ## cob_opTrabajadores de Servicio y Vendedores -6.190e-01 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros -1.428e+00 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros -6.004e-01 ## cob_opOperadores de Instalaciones y Maquinarias -4.837e-01 ## cob_opTrabajadores No Calificados -7.000e-01 ## Std. Error ## (Intercept) 1.384e-01 ## s02a_022.Mujer 1.974e-02 ## s02a_03 5.962e-04 ## aestudio 2.077e-03 ## tothrs 4.437e-04 ## ynolab 9.295e-06 ## areaRural 2.373e-02 ## cob_opDirectivos Adm. Pública y Empresas 1.354e-01 ## cob_opProfesionales cientificos e intelectuales 1.296e-01 ## cob_opTécnicos de Nivel Medio 1.306e-01 ## cob_opEmpleados de oficina 1.366e-01 ## cob_opTrabajadores de Servicio y Vendedores 1.293e-01 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros 1.309e-01 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros 1.288e-01 ## cob_opOperadores de Instalaciones y Maquinarias 1.292e-01 ## cob_opTrabajadores No Calificados 1.314e-01 ## t value ## (Intercept) 59.505 ## s02a_022.Mujer -17.656 ## s02a_03 -13.620 ## aestudio 12.491 ## tothrs 19.198 ## ynolab -2.180 ## areaRural -11.891 ## cob_opDirectivos Adm. Pública y Empresas 0.296 ## cob_opProfesionales cientificos e intelectuales -0.075 ## cob_opTécnicos de Nivel Medio -2.870 ## cob_opEmpleados de oficina -3.324 ## cob_opTrabajadores de Servicio y Vendedores -4.789 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros -10.910 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros -4.663 ## cob_opOperadores de Instalaciones y Maquinarias -3.744 ## cob_opTrabajadores No Calificados -5.327 ## Pr(&gt;|t|) ## (Intercept) &lt; 2e-16 ## s02a_022.Mujer &lt; 2e-16 ## s02a_03 &lt; 2e-16 ## aestudio &lt; 2e-16 ## tothrs &lt; 2e-16 ## ynolab 0.029280 ## areaRural &lt; 2e-16 ## cob_opDirectivos Adm. Pública y Empresas 0.767563 ## cob_opProfesionales cientificos e intelectuales 0.940448 ## cob_opTécnicos de Nivel Medio 0.004116 ## cob_opEmpleados de oficina 0.000890 ## cob_opTrabajadores de Servicio y Vendedores 1.71e-06 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros &lt; 2e-16 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros 3.16e-06 ## cob_opOperadores de Instalaciones y Maquinarias 0.000182 ## cob_opTrabajadores No Calificados 1.02e-07 ## ## (Intercept) *** ## s02a_022.Mujer *** ## s02a_03 *** ## aestudio *** ## tothrs *** ## ynolab * ## areaRural *** ## cob_opDirectivos Adm. Pública y Empresas ## cob_opProfesionales cientificos e intelectuales ## cob_opTécnicos de Nivel Medio ** ## cob_opEmpleados de oficina *** ## cob_opTrabajadores de Servicio y Vendedores *** ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros *** ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros *** ## cob_opOperadores de Instalaciones y Maquinarias *** ## cob_opTrabajadores No Calificados *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.7177 on 9278 degrees of freedom ## (122 observations deleted due to missingness) ## Multiple R-squared: 0.4648, Adjusted R-squared: 0.4639 ## F-statistic: 537.1 on 15 and 9278 DF, p-value: &lt; 2.2e-16 m6&lt;-step(m5) ## Start: AIC=-6148.87 ## log(ylab) ~ s02a_02 + s02a_03 + aestudio + tothrs + ynolab + ## area + cob_op ## ## Df Sum of Sq RSS AIC ## &lt;none&gt; 4779.5 -6148.9 ## - ynolab 1 2.45 4781.9 -6146.1 ## - area 1 72.84 4852.3 -6010.3 ## - aestudio 1 80.38 4859.9 -5995.9 ## - s02a_03 1 95.56 4875.0 -5966.9 ## - s02a_02 1 160.59 4940.1 -5843.7 ## - tothrs 1 189.86 4969.3 -5788.8 ## - cob_op 9 812.38 5591.9 -4707.9 summary(m6) ## ## Call: ## lm(formula = log(ylab) ~ s02a_02 + s02a_03 + aestudio + tothrs + ## ynolab + area + cob_op, data = bd[, -c(7, 8, 9, 11)]) ## ## Residuals: ## Min 1Q Median 3Q Max ## -5.0630 -0.3653 0.0333 0.4194 2.9355 ## ## Coefficients: ## Estimate ## (Intercept) 8.233e+00 ## s02a_022.Mujer -3.486e-01 ## s02a_03 -8.120e-03 ## aestudio 2.595e-02 ## tothrs 8.519e-03 ## ynolab -2.026e-05 ## areaRural -2.821e-01 ## cob_opDirectivos Adm. Pública y Empresas 4.002e-02 ## cob_opProfesionales cientificos e intelectuales -9.679e-03 ## cob_opTécnicos de Nivel Medio -3.748e-01 ## cob_opEmpleados de oficina -4.541e-01 ## cob_opTrabajadores de Servicio y Vendedores -6.190e-01 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros -1.428e+00 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros -6.004e-01 ## cob_opOperadores de Instalaciones y Maquinarias -4.837e-01 ## cob_opTrabajadores No Calificados -7.000e-01 ## Std. Error ## (Intercept) 1.384e-01 ## s02a_022.Mujer 1.974e-02 ## s02a_03 5.962e-04 ## aestudio 2.077e-03 ## tothrs 4.437e-04 ## ynolab 9.295e-06 ## areaRural 2.373e-02 ## cob_opDirectivos Adm. Pública y Empresas 1.354e-01 ## cob_opProfesionales cientificos e intelectuales 1.296e-01 ## cob_opTécnicos de Nivel Medio 1.306e-01 ## cob_opEmpleados de oficina 1.366e-01 ## cob_opTrabajadores de Servicio y Vendedores 1.293e-01 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros 1.309e-01 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros 1.288e-01 ## cob_opOperadores de Instalaciones y Maquinarias 1.292e-01 ## cob_opTrabajadores No Calificados 1.314e-01 ## t value ## (Intercept) 59.505 ## s02a_022.Mujer -17.656 ## s02a_03 -13.620 ## aestudio 12.491 ## tothrs 19.198 ## ynolab -2.180 ## areaRural -11.891 ## cob_opDirectivos Adm. Pública y Empresas 0.296 ## cob_opProfesionales cientificos e intelectuales -0.075 ## cob_opTécnicos de Nivel Medio -2.870 ## cob_opEmpleados de oficina -3.324 ## cob_opTrabajadores de Servicio y Vendedores -4.789 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros -10.910 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros -4.663 ## cob_opOperadores de Instalaciones y Maquinarias -3.744 ## cob_opTrabajadores No Calificados -5.327 ## Pr(&gt;|t|) ## (Intercept) &lt; 2e-16 ## s02a_022.Mujer &lt; 2e-16 ## s02a_03 &lt; 2e-16 ## aestudio &lt; 2e-16 ## tothrs &lt; 2e-16 ## ynolab 0.029280 ## areaRural &lt; 2e-16 ## cob_opDirectivos Adm. Pública y Empresas 0.767563 ## cob_opProfesionales cientificos e intelectuales 0.940448 ## cob_opTécnicos de Nivel Medio 0.004116 ## cob_opEmpleados de oficina 0.000890 ## cob_opTrabajadores de Servicio y Vendedores 1.71e-06 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros &lt; 2e-16 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros 3.16e-06 ## cob_opOperadores de Instalaciones y Maquinarias 0.000182 ## cob_opTrabajadores No Calificados 1.02e-07 ## ## (Intercept) *** ## s02a_022.Mujer *** ## s02a_03 *** ## aestudio *** ## tothrs *** ## ynolab * ## areaRural *** ## cob_opDirectivos Adm. Pública y Empresas ## cob_opProfesionales cientificos e intelectuales ## cob_opTécnicos de Nivel Medio ** ## cob_opEmpleados de oficina *** ## cob_opTrabajadores de Servicio y Vendedores *** ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros *** ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros *** ## cob_opOperadores de Instalaciones y Maquinarias *** ## cob_opTrabajadores No Calificados *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.7177 on 9278 degrees of freedom ## (122 observations deleted due to missingness) ## Multiple R-squared: 0.4648, Adjusted R-squared: 0.4639 ## F-statistic: 537.1 on 15 and 9278 DF, p-value: &lt; 2.2e-16 #un ejemplo de laboratorio bd2&lt;-as.data.frame(matrix(rnorm(1000),ncol = 8)) names(bd2)[1]&lt;-&quot;y&quot; bd2$x&lt;-bd2$y+runif(125) plot(bd2$x,bd2$y) plot(bd2) p1&lt;-lm(y~.,data=bd2) summary(p1) ## ## Call: ## lm(formula = y ~ ., data = bd2) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.5622 -0.1857 -0.0145 0.2288 0.4976 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -0.432520 0.028175 -15.351 &lt;2e-16 *** ## V2 0.005795 0.024548 0.236 0.8138 ## V3 0.022484 0.025552 0.880 0.3807 ## V4 -0.004651 0.027379 -0.170 0.8654 ## V5 0.010813 0.025409 0.426 0.6712 ## V6 0.063172 0.028226 2.238 0.0271 * ## V7 -0.026947 0.022566 -1.194 0.2348 ## V8 -0.009801 0.024734 -0.396 0.6926 ## x 0.894723 0.026515 33.744 &lt;2e-16 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.2756 on 116 degrees of freedom ## Multiple R-squared: 0.9145, Adjusted R-squared: 0.9086 ## F-statistic: 155.1 on 8 and 116 DF, p-value: &lt; 2.2e-16 p2&lt;-step(p1) ## Start: AIC=-313.54 ## y ~ V2 + V3 + V4 + V5 + V6 + V7 + V8 + x ## ## Df Sum of Sq RSS AIC ## - V4 1 0.002 8.813 -315.507 ## - V2 1 0.004 8.815 -315.478 ## - V8 1 0.012 8.823 -315.369 ## - V5 1 0.014 8.825 -315.343 ## - V3 1 0.059 8.870 -314.706 ## - V7 1 0.108 8.919 -314.010 ## &lt;none&gt; 8.811 -313.538 ## - V6 1 0.380 9.192 -310.253 ## - x 1 86.488 95.300 -17.911 ## ## Step: AIC=-315.51 ## y ~ V2 + V3 + V5 + V6 + V7 + V8 + x ## ## Df Sum of Sq RSS AIC ## - V2 1 0.004 8.818 -317.44 ## - V8 1 0.013 8.826 -317.33 ## - V5 1 0.014 8.827 -317.31 ## - V3 1 0.060 8.873 -316.66 ## - V7 1 0.108 8.921 -315.99 ## &lt;none&gt; 8.813 -315.51 ## - V6 1 0.381 9.194 -312.22 ## - x 1 86.968 95.781 -19.28 ## ## Step: AIC=-317.44 ## y ~ V3 + V5 + V6 + V7 + V8 + x ## ## Df Sum of Sq RSS AIC ## - V8 1 0.011 8.829 -319.29 ## - V5 1 0.014 8.832 -319.25 ## - V3 1 0.058 8.876 -318.63 ## - V7 1 0.110 8.928 -317.89 ## &lt;none&gt; 8.818 -317.44 ## - V6 1 0.377 9.195 -314.21 ## - x 1 90.028 98.846 -17.34 ## ## Step: AIC=-319.29 ## y ~ V3 + V5 + V6 + V7 + x ## ## Df Sum of Sq RSS AIC ## - V5 1 0.013 8.842 -321.11 ## - V3 1 0.062 8.891 -320.41 ## - V7 1 0.113 8.942 -319.69 ## &lt;none&gt; 8.829 -319.29 ## - V6 1 0.373 9.202 -316.12 ## - x 1 90.090 98.919 -19.25 ## ## Step: AIC=-321.11 ## y ~ V3 + V6 + V7 + x ## ## Df Sum of Sq RSS AIC ## - V3 1 0.073 8.915 -322.08 ## - V7 1 0.117 8.958 -321.47 ## &lt;none&gt; 8.842 -321.11 ## - V6 1 0.375 9.217 -317.91 ## - x 1 90.960 99.802 -20.14 ## ## Step: AIC=-322.08 ## y ~ V6 + V7 + x ## ## Df Sum of Sq RSS AIC ## - V7 1 0.104 9.018 -322.63 ## &lt;none&gt; 8.915 -322.08 ## - V6 1 0.369 9.283 -319.01 ## - x 1 92.360 101.275 -20.31 ## ## Step: AIC=-322.63 ## y ~ V6 + x ## ## Df Sum of Sq RSS AIC ## &lt;none&gt; 9.018 -322.63 ## - V6 1 0.376 9.395 -319.52 ## - x 1 92.604 101.622 -21.88 summary(p2) ## ## Call: ## lm(formula = y ~ V6 + x, data = bd2) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.52774 -0.19535 -0.02381 0.23658 0.53482 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -0.44019 0.02696 -16.325 &lt;2e-16 *** ## V6 0.06204 0.02750 2.256 0.0258 * ## x 0.89783 0.02537 35.394 &lt;2e-16 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.2719 on 122 degrees of freedom ## Multiple R-squared: 0.9125, Adjusted R-squared: 0.911 ## F-statistic: 636 on 2 and 122 DF, p-value: &lt; 2.2e-16 Nota: Se debe tener en cuenta siempre la fuente de la información summary(m4) ## ## Call: ## lm(formula = log(ylab) ~ s02a_03 + factor(aestudio) + tothrs + ## ynolab + s02a_02 + area + cob_op, data = bd) ## ## Residuals: ## Min 1Q Median 3Q Max ## -4.7206 -0.3539 0.0312 0.4048 3.1249 ## ## Coefficients: ## Estimate ## (Intercept) 7.820e+00 ## s02a_03 -7.844e-03 ## factor(aestudio)1 3.339e-01 ## factor(aestudio)2 4.623e-01 ## factor(aestudio)3 4.087e-01 ## factor(aestudio)4 4.968e-01 ## factor(aestudio)5 5.998e-01 ## factor(aestudio)6 5.960e-01 ## factor(aestudio)7 7.228e-01 ## factor(aestudio)8 6.500e-01 ## factor(aestudio)9 5.755e-01 ## factor(aestudio)10 6.404e-01 ## factor(aestudio)11 5.875e-01 ## factor(aestudio)12 6.286e-01 ## factor(aestudio)13 4.730e-01 ## factor(aestudio)14 6.351e-01 ## factor(aestudio)15 6.638e-01 ## factor(aestudio)16 7.217e-01 ## factor(aestudio)17 8.747e-01 ## factor(aestudio)18 1.006e+00 ## factor(aestudio)19 1.167e+00 ## factor(aestudio)22 1.173e+00 ## tothrs 8.296e-03 ## ynolab -2.202e-05 ## s02a_022.Mujer -3.238e-01 ## areaRural -2.754e-01 ## cob_opDirectivos Adm. Pública y Empresas 4.876e-02 ## cob_opProfesionales cientificos e intelectuales -5.148e-02 ## cob_opTécnicos de Nivel Medio -3.047e-01 ## cob_opEmpleados de oficina -4.010e-01 ## cob_opTrabajadores de Servicio y Vendedores -5.664e-01 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros -1.369e+00 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros -5.489e-01 ## cob_opOperadores de Instalaciones y Maquinarias -4.296e-01 ## cob_opTrabajadores No Calificados -6.543e-01 ## Std. Error ## (Intercept) 1.424e-01 ## s02a_03 6.022e-04 ## factor(aestudio)1 6.822e-02 ## factor(aestudio)2 5.362e-02 ## factor(aestudio)3 4.965e-02 ## factor(aestudio)4 5.229e-02 ## factor(aestudio)5 4.685e-02 ## factor(aestudio)6 5.512e-02 ## factor(aestudio)7 6.277e-02 ## factor(aestudio)8 5.242e-02 ## factor(aestudio)9 5.924e-02 ## factor(aestudio)10 5.537e-02 ## factor(aestudio)11 5.515e-02 ## factor(aestudio)12 4.530e-02 ## factor(aestudio)13 7.556e-02 ## factor(aestudio)14 6.006e-02 ## factor(aestudio)15 5.741e-02 ## factor(aestudio)16 6.873e-02 ## factor(aestudio)17 5.384e-02 ## factor(aestudio)18 9.785e-02 ## factor(aestudio)19 1.039e-01 ## factor(aestudio)22 3.228e-01 ## tothrs 4.409e-04 ## ynolab 9.220e-06 ## s02a_022.Mujer 1.975e-02 ## areaRural 2.356e-02 ## cob_opDirectivos Adm. Pública y Empresas 1.346e-01 ## cob_opProfesionales cientificos e intelectuales 1.287e-01 ## cob_opTécnicos de Nivel Medio 1.305e-01 ## cob_opEmpleados de oficina 1.362e-01 ## cob_opTrabajadores de Servicio y Vendedores 1.299e-01 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros 1.314e-01 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros 1.296e-01 ## cob_opOperadores de Instalaciones y Maquinarias 1.301e-01 ## cob_opTrabajadores No Calificados 1.322e-01 ## t value ## (Intercept) 54.901 ## s02a_03 -13.026 ## factor(aestudio)1 4.894 ## factor(aestudio)2 8.621 ## factor(aestudio)3 8.232 ## factor(aestudio)4 9.500 ## factor(aestudio)5 12.802 ## factor(aestudio)6 10.812 ## factor(aestudio)7 11.515 ## factor(aestudio)8 12.401 ## factor(aestudio)9 9.715 ## factor(aestudio)10 11.565 ## factor(aestudio)11 10.653 ## factor(aestudio)12 13.877 ## factor(aestudio)13 6.261 ## factor(aestudio)14 10.575 ## factor(aestudio)15 11.562 ## factor(aestudio)16 10.500 ## factor(aestudio)17 16.247 ## factor(aestudio)18 10.285 ## factor(aestudio)19 11.226 ## factor(aestudio)22 3.634 ## tothrs 18.817 ## ynolab -2.388 ## s02a_022.Mujer -16.399 ## areaRural -11.690 ## cob_opDirectivos Adm. Pública y Empresas 0.362 ## cob_opProfesionales cientificos e intelectuales -0.400 ## cob_opTécnicos de Nivel Medio -2.335 ## cob_opEmpleados de oficina -2.943 ## cob_opTrabajadores de Servicio y Vendedores -4.360 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros -10.421 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros -4.234 ## cob_opOperadores de Instalaciones y Maquinarias -3.303 ## cob_opTrabajadores No Calificados -4.951 ## Pr(&gt;|t|) ## (Intercept) &lt; 2e-16 ## s02a_03 &lt; 2e-16 ## factor(aestudio)1 1.00e-06 ## factor(aestudio)2 &lt; 2e-16 ## factor(aestudio)3 &lt; 2e-16 ## factor(aestudio)4 &lt; 2e-16 ## factor(aestudio)5 &lt; 2e-16 ## factor(aestudio)6 &lt; 2e-16 ## factor(aestudio)7 &lt; 2e-16 ## factor(aestudio)8 &lt; 2e-16 ## factor(aestudio)9 &lt; 2e-16 ## factor(aestudio)10 &lt; 2e-16 ## factor(aestudio)11 &lt; 2e-16 ## factor(aestudio)12 &lt; 2e-16 ## factor(aestudio)13 4.01e-10 ## factor(aestudio)14 &lt; 2e-16 ## factor(aestudio)15 &lt; 2e-16 ## factor(aestudio)16 &lt; 2e-16 ## factor(aestudio)17 &lt; 2e-16 ## factor(aestudio)18 &lt; 2e-16 ## factor(aestudio)19 &lt; 2e-16 ## factor(aestudio)22 0.000280 ## tothrs &lt; 2e-16 ## ynolab 0.016945 ## s02a_022.Mujer &lt; 2e-16 ## areaRural &lt; 2e-16 ## cob_opDirectivos Adm. Pública y Empresas 0.717174 ## cob_opProfesionales cientificos e intelectuales 0.689269 ## cob_opTécnicos de Nivel Medio 0.019552 ## cob_opEmpleados de oficina 0.003254 ## cob_opTrabajadores de Servicio y Vendedores 1.31e-05 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros &lt; 2e-16 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros 2.32e-05 ## cob_opOperadores de Instalaciones y Maquinarias 0.000959 ## cob_opTrabajadores No Calificados 7.53e-07 ## ## (Intercept) *** ## s02a_03 *** ## factor(aestudio)1 *** ## factor(aestudio)2 *** ## factor(aestudio)3 *** ## factor(aestudio)4 *** ## factor(aestudio)5 *** ## factor(aestudio)6 *** ## factor(aestudio)7 *** ## factor(aestudio)8 *** ## factor(aestudio)9 *** ## factor(aestudio)10 *** ## factor(aestudio)11 *** ## factor(aestudio)12 *** ## factor(aestudio)13 *** ## factor(aestudio)14 *** ## factor(aestudio)15 *** ## factor(aestudio)16 *** ## factor(aestudio)17 *** ## factor(aestudio)18 *** ## factor(aestudio)19 *** ## factor(aestudio)22 *** ## tothrs *** ## ynolab * ## s02a_022.Mujer *** ## areaRural *** ## cob_opDirectivos Adm. Pública y Empresas ## cob_opProfesionales cientificos e intelectuales ## cob_opTécnicos de Nivel Medio * ## cob_opEmpleados de oficina ** ## cob_opTrabajadores de Servicio y Vendedores *** ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros *** ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros *** ## cob_opOperadores de Instalaciones y Maquinarias *** ## cob_opTrabajadores No Calificados *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.7112 on 9259 degrees of freedom ## (122 observations deleted due to missingness) ## Multiple R-squared: 0.4756, Adjusted R-squared: 0.4736 ## F-statistic: 246.9 on 34 and 9259 DF, p-value: &lt; 2.2e-16 summary(lm(ylab~factor(aestudio)+s02a_02+s02a_03,data=bd)) ## ## Call: ## lm(formula = ylab ~ factor(aestudio) + s02a_02 + s02a_03, data = bd) ## ## Residuals: ## Min 1Q Median 3Q Max ## -7361.6 -1252.5 -342.9 764.6 30418.2 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 1665.189 159.626 10.432 &lt; 2e-16 *** ## factor(aestudio)1 568.243 202.170 2.811 0.004954 ** ## factor(aestudio)2 556.047 158.745 3.503 0.000463 *** ## factor(aestudio)3 696.836 146.762 4.748 2.08e-06 *** ## factor(aestudio)4 748.466 154.487 4.845 1.29e-06 *** ## factor(aestudio)5 1077.434 137.201 7.853 4.52e-15 *** ## factor(aestudio)6 1135.656 161.909 7.014 2.47e-12 *** ## factor(aestudio)7 1574.346 184.546 8.531 &lt; 2e-16 *** ## factor(aestudio)8 1521.542 153.316 9.924 &lt; 2e-16 *** ## factor(aestudio)9 1375.030 173.739 7.914 2.77e-15 *** ## factor(aestudio)10 1504.922 161.697 9.307 &lt; 2e-16 *** ## factor(aestudio)11 1580.885 159.966 9.883 &lt; 2e-16 *** ## factor(aestudio)12 1786.663 129.276 13.821 &lt; 2e-16 *** ## factor(aestudio)13 1488.092 219.978 6.765 1.42e-11 *** ## factor(aestudio)14 2119.174 171.208 12.378 &lt; 2e-16 *** ## factor(aestudio)15 2241.471 161.555 13.874 &lt; 2e-16 *** ## factor(aestudio)16 2449.584 195.909 12.504 &lt; 2e-16 *** ## factor(aestudio)17 3719.149 132.454 28.079 &lt; 2e-16 *** ## factor(aestudio)18 4782.166 273.066 17.513 &lt; 2e-16 *** ## factor(aestudio)19 6556.931 290.647 22.560 &lt; 2e-16 *** ## factor(aestudio)22 7270.592 952.876 7.630 2.58e-14 *** ## s02a_022.Mujer -720.915 52.095 -13.839 &lt; 2e-16 *** ## s02a_03 -2.390 1.741 -1.372 0.169943 ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 2115 on 9273 degrees of freedom ## (120 observations deleted due to missingness) ## Multiple R-squared: 0.2256, Adjusted R-squared: 0.2238 ## F-statistic: 122.8 on 22 and 9273 DF, p-value: &lt; 2.2e-16 summary(lm(log(ylab)~factor(aestudio)+s02a_02+s02a_03,data=bd)) ## ## Call: ## lm(formula = log(ylab) ~ factor(aestudio) + s02a_02 + s02a_03, ## data = bd) ## ## Residuals: ## Min 1Q Median 3Q Max ## -5.0522 -0.3568 0.0987 0.4981 3.2963 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 7.0748965 0.0626415 112.943 &lt; 2e-16 ## factor(aestudio)1 0.5577081 0.0793369 7.030 2.22e-12 ## factor(aestudio)2 0.6629018 0.0622958 10.641 &lt; 2e-16 ## factor(aestudio)3 0.6750163 0.0575931 11.720 &lt; 2e-16 ## factor(aestudio)4 0.7840809 0.0606245 12.933 &lt; 2e-16 ## factor(aestudio)5 1.0183809 0.0538412 18.915 &lt; 2e-16 ## factor(aestudio)6 1.0408567 0.0635372 16.382 &lt; 2e-16 ## factor(aestudio)7 1.2169718 0.0724208 16.804 &lt; 2e-16 ## factor(aestudio)8 1.1424786 0.0601650 18.989 &lt; 2e-16 ## factor(aestudio)9 1.0948564 0.0681796 16.058 &lt; 2e-16 ## factor(aestudio)10 1.1867662 0.0634540 18.703 &lt; 2e-16 ## factor(aestudio)11 1.2047681 0.0627746 19.192 &lt; 2e-16 ## factor(aestudio)12 1.2887095 0.0507313 25.403 &lt; 2e-16 ## factor(aestudio)13 1.1553818 0.0863251 13.384 &lt; 2e-16 ## factor(aestudio)14 1.3888708 0.0671865 20.672 &lt; 2e-16 ## factor(aestudio)15 1.4537603 0.0633982 22.931 &lt; 2e-16 ## factor(aestudio)16 1.5138924 0.0768798 19.692 &lt; 2e-16 ## factor(aestudio)17 1.8574646 0.0519783 35.735 &lt; 2e-16 ## factor(aestudio)18 2.0420014 0.1071580 19.056 &lt; 2e-16 ## factor(aestudio)19 2.2508731 0.1140574 19.735 &lt; 2e-16 ## factor(aestudio)22 2.4462753 0.3739333 6.542 6.39e-11 ## s02a_022.Mujer -0.2733157 0.0204432 -13.369 &lt; 2e-16 ## s02a_03 -0.0109058 0.0006833 -15.960 &lt; 2e-16 ## ## (Intercept) *** ## factor(aestudio)1 *** ## factor(aestudio)2 *** ## factor(aestudio)3 *** ## factor(aestudio)4 *** ## factor(aestudio)5 *** ## factor(aestudio)6 *** ## factor(aestudio)7 *** ## factor(aestudio)8 *** ## factor(aestudio)9 *** ## factor(aestudio)10 *** ## factor(aestudio)11 *** ## factor(aestudio)12 *** ## factor(aestudio)13 *** ## factor(aestudio)14 *** ## factor(aestudio)15 *** ## factor(aestudio)16 *** ## factor(aestudio)17 *** ## factor(aestudio)18 *** ## factor(aestudio)19 *** ## factor(aestudio)22 *** ## s02a_022.Mujer *** ## s02a_03 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.8299 on 9273 degrees of freedom ## (120 observations deleted due to missingness) ## Multiple R-squared: 0.2848, Adjusted R-squared: 0.2831 ## F-statistic: 167.9 on 22 and 9273 DF, p-value: &lt; 2.2e-16 #estamos suponiendo una relación lineal #las relaciones que encontramos son a nivel de la muestra #para hacer inferencia el mejor camino es la libreria survey summary(lm(log(ylab)~factor(aestudio)+s02a_02+s02a_03,data=bd))#MCO,OLS ## ## Call: ## lm(formula = log(ylab) ~ factor(aestudio) + s02a_02 + s02a_03, ## data = bd) ## ## Residuals: ## Min 1Q Median 3Q Max ## -5.0522 -0.3568 0.0987 0.4981 3.2963 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 7.0748965 0.0626415 112.943 &lt; 2e-16 ## factor(aestudio)1 0.5577081 0.0793369 7.030 2.22e-12 ## factor(aestudio)2 0.6629018 0.0622958 10.641 &lt; 2e-16 ## factor(aestudio)3 0.6750163 0.0575931 11.720 &lt; 2e-16 ## factor(aestudio)4 0.7840809 0.0606245 12.933 &lt; 2e-16 ## factor(aestudio)5 1.0183809 0.0538412 18.915 &lt; 2e-16 ## factor(aestudio)6 1.0408567 0.0635372 16.382 &lt; 2e-16 ## factor(aestudio)7 1.2169718 0.0724208 16.804 &lt; 2e-16 ## factor(aestudio)8 1.1424786 0.0601650 18.989 &lt; 2e-16 ## factor(aestudio)9 1.0948564 0.0681796 16.058 &lt; 2e-16 ## factor(aestudio)10 1.1867662 0.0634540 18.703 &lt; 2e-16 ## factor(aestudio)11 1.2047681 0.0627746 19.192 &lt; 2e-16 ## factor(aestudio)12 1.2887095 0.0507313 25.403 &lt; 2e-16 ## factor(aestudio)13 1.1553818 0.0863251 13.384 &lt; 2e-16 ## factor(aestudio)14 1.3888708 0.0671865 20.672 &lt; 2e-16 ## factor(aestudio)15 1.4537603 0.0633982 22.931 &lt; 2e-16 ## factor(aestudio)16 1.5138924 0.0768798 19.692 &lt; 2e-16 ## factor(aestudio)17 1.8574646 0.0519783 35.735 &lt; 2e-16 ## factor(aestudio)18 2.0420014 0.1071580 19.056 &lt; 2e-16 ## factor(aestudio)19 2.2508731 0.1140574 19.735 &lt; 2e-16 ## factor(aestudio)22 2.4462753 0.3739333 6.542 6.39e-11 ## s02a_022.Mujer -0.2733157 0.0204432 -13.369 &lt; 2e-16 ## s02a_03 -0.0109058 0.0006833 -15.960 &lt; 2e-16 ## ## (Intercept) *** ## factor(aestudio)1 *** ## factor(aestudio)2 *** ## factor(aestudio)3 *** ## factor(aestudio)4 *** ## factor(aestudio)5 *** ## factor(aestudio)6 *** ## factor(aestudio)7 *** ## factor(aestudio)8 *** ## factor(aestudio)9 *** ## factor(aestudio)10 *** ## factor(aestudio)11 *** ## factor(aestudio)12 *** ## factor(aestudio)13 *** ## factor(aestudio)14 *** ## factor(aestudio)15 *** ## factor(aestudio)16 *** ## factor(aestudio)17 *** ## factor(aestudio)18 *** ## factor(aestudio)19 *** ## factor(aestudio)22 *** ## s02a_022.Mujer *** ## s02a_03 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.8299 on 9273 degrees of freedom ## (120 observations deleted due to missingness) ## Multiple R-squared: 0.2848, Adjusted R-squared: 0.2831 ## F-statistic: 167.9 on 22 and 9273 DF, p-value: &lt; 2.2e-16 summary(lm(log(ylab)~factor(aestudio)+s02a_02+s02a_03 ,weights = factor ,data=bd))#MCP ## ## Call: ## lm(formula = log(ylab) ~ factor(aestudio) + s02a_02 + s02a_03, ## data = bd, weights = factor) ## ## Weighted Residuals: ## Min 1Q Median 3Q Max ## -151.201 -5.156 2.379 9.436 71.710 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 7.090179 0.065421 108.378 &lt; 2e-16 ## factor(aestudio)1 0.614074 0.079910 7.685 1.69e-14 ## factor(aestudio)2 0.682190 0.062068 10.991 &lt; 2e-16 ## factor(aestudio)3 0.608825 0.057584 10.573 &lt; 2e-16 ## factor(aestudio)4 0.792066 0.061379 12.904 &lt; 2e-16 ## factor(aestudio)5 1.066464 0.054404 19.603 &lt; 2e-16 ## factor(aestudio)6 1.080387 0.064995 16.623 &lt; 2e-16 ## factor(aestudio)7 1.384734 0.076515 18.098 &lt; 2e-16 ## factor(aestudio)8 1.177247 0.061942 19.006 &lt; 2e-16 ## factor(aestudio)9 1.180563 0.072530 16.277 &lt; 2e-16 ## factor(aestudio)10 1.227639 0.065420 18.765 &lt; 2e-16 ## factor(aestudio)11 1.313002 0.065803 19.953 &lt; 2e-16 ## factor(aestudio)12 1.378576 0.051212 26.919 &lt; 2e-16 ## factor(aestudio)13 1.298265 0.093821 13.838 &lt; 2e-16 ## factor(aestudio)14 1.555716 0.071851 21.652 &lt; 2e-16 ## factor(aestudio)15 1.580543 0.068034 23.232 &lt; 2e-16 ## factor(aestudio)16 1.568266 0.084698 18.516 &lt; 2e-16 ## factor(aestudio)17 1.995923 0.052848 37.768 &lt; 2e-16 ## factor(aestudio)18 2.207417 0.119783 18.429 &lt; 2e-16 ## factor(aestudio)19 2.386930 0.128729 18.542 &lt; 2e-16 ## factor(aestudio)22 2.465356 0.403558 6.109 1.04e-09 ## s02a_022.Mujer -0.228750 0.022758 -10.051 &lt; 2e-16 ## s02a_03 -0.014892 0.000744 -20.017 &lt; 2e-16 ## ## (Intercept) *** ## factor(aestudio)1 *** ## factor(aestudio)2 *** ## factor(aestudio)3 *** ## factor(aestudio)4 *** ## factor(aestudio)5 *** ## factor(aestudio)6 *** ## factor(aestudio)7 *** ## factor(aestudio)8 *** ## factor(aestudio)9 *** ## factor(aestudio)10 *** ## factor(aestudio)11 *** ## factor(aestudio)12 *** ## factor(aestudio)13 *** ## factor(aestudio)14 *** ## factor(aestudio)15 *** ## factor(aestudio)16 *** ## factor(aestudio)17 *** ## factor(aestudio)18 *** ## factor(aestudio)19 *** ## factor(aestudio)22 *** ## s02a_022.Mujer *** ## s02a_03 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 16.14 on 9273 degrees of freedom ## (120 observations deleted due to missingness) ## Multiple R-squared: 0.3201, Adjusted R-squared: 0.3185 ## F-statistic: 198.4 on 22 and 9273 DF, p-value: &lt; 2.2e-16 4.1.5 Paso 5: Validar el modelo #Supuestos del modelo ## los errores se distribuyen normal(media=0, varianza=constante) ## Independencia entre los X del modelo # los errores se distribuyen normal model&lt;-lm(log(ylab)~s02a_03+aestudio+tothrs+ynolab+s02a_02+area+cob_op,data=bd) summary(model) ## ## Call: ## lm(formula = log(ylab) ~ s02a_03 + aestudio + tothrs + ynolab + ## s02a_02 + area + cob_op, data = bd) ## ## Residuals: ## Min 1Q Median 3Q Max ## -5.0630 -0.3653 0.0333 0.4194 2.9355 ## ## Coefficients: ## Estimate ## (Intercept) 8.233e+00 ## s02a_03 -8.120e-03 ## aestudio 2.595e-02 ## tothrs 8.519e-03 ## ynolab -2.026e-05 ## s02a_022.Mujer -3.486e-01 ## areaRural -2.821e-01 ## cob_opDirectivos Adm. Pública y Empresas 4.002e-02 ## cob_opProfesionales cientificos e intelectuales -9.679e-03 ## cob_opTécnicos de Nivel Medio -3.748e-01 ## cob_opEmpleados de oficina -4.541e-01 ## cob_opTrabajadores de Servicio y Vendedores -6.190e-01 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros -1.428e+00 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros -6.004e-01 ## cob_opOperadores de Instalaciones y Maquinarias -4.837e-01 ## cob_opTrabajadores No Calificados -7.000e-01 ## Std. Error ## (Intercept) 1.384e-01 ## s02a_03 5.962e-04 ## aestudio 2.077e-03 ## tothrs 4.437e-04 ## ynolab 9.295e-06 ## s02a_022.Mujer 1.974e-02 ## areaRural 2.373e-02 ## cob_opDirectivos Adm. Pública y Empresas 1.354e-01 ## cob_opProfesionales cientificos e intelectuales 1.296e-01 ## cob_opTécnicos de Nivel Medio 1.306e-01 ## cob_opEmpleados de oficina 1.366e-01 ## cob_opTrabajadores de Servicio y Vendedores 1.293e-01 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros 1.309e-01 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros 1.288e-01 ## cob_opOperadores de Instalaciones y Maquinarias 1.292e-01 ## cob_opTrabajadores No Calificados 1.314e-01 ## t value ## (Intercept) 59.505 ## s02a_03 -13.620 ## aestudio 12.491 ## tothrs 19.198 ## ynolab -2.180 ## s02a_022.Mujer -17.656 ## areaRural -11.891 ## cob_opDirectivos Adm. Pública y Empresas 0.296 ## cob_opProfesionales cientificos e intelectuales -0.075 ## cob_opTécnicos de Nivel Medio -2.870 ## cob_opEmpleados de oficina -3.324 ## cob_opTrabajadores de Servicio y Vendedores -4.789 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros -10.910 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros -4.663 ## cob_opOperadores de Instalaciones y Maquinarias -3.744 ## cob_opTrabajadores No Calificados -5.327 ## Pr(&gt;|t|) ## (Intercept) &lt; 2e-16 ## s02a_03 &lt; 2e-16 ## aestudio &lt; 2e-16 ## tothrs &lt; 2e-16 ## ynolab 0.029280 ## s02a_022.Mujer &lt; 2e-16 ## areaRural &lt; 2e-16 ## cob_opDirectivos Adm. Pública y Empresas 0.767563 ## cob_opProfesionales cientificos e intelectuales 0.940448 ## cob_opTécnicos de Nivel Medio 0.004116 ## cob_opEmpleados de oficina 0.000890 ## cob_opTrabajadores de Servicio y Vendedores 1.71e-06 ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros &lt; 2e-16 ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros 3.16e-06 ## cob_opOperadores de Instalaciones y Maquinarias 0.000182 ## cob_opTrabajadores No Calificados 1.02e-07 ## ## (Intercept) *** ## s02a_03 *** ## aestudio *** ## tothrs *** ## ynolab * ## s02a_022.Mujer *** ## areaRural *** ## cob_opDirectivos Adm. Pública y Empresas ## cob_opProfesionales cientificos e intelectuales ## cob_opTécnicos de Nivel Medio ** ## cob_opEmpleados de oficina *** ## cob_opTrabajadores de Servicio y Vendedores *** ## cob_opTrabajadores en Agricultura, Pecuaria,Pesca y otros *** ## cob_opTrabajadores de la Construcción, Ind. Manufacturera y Otros *** ## cob_opOperadores de Instalaciones y Maquinarias *** ## cob_opTrabajadores No Calificados *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.7177 on 9278 degrees of freedom ## (122 observations deleted due to missingness) ## Multiple R-squared: 0.4648, Adjusted R-squared: 0.4639 ## F-statistic: 537.1 on 15 and 9278 DF, p-value: &lt; 2.2e-16 par(mfrow=c(2,2)) plot(model) dev.off() ## null device ## 1 #errores ee&lt;-residuals(model) plot(density(ee)) #prueba de normalidad #H0 x ~ normal() library(normtest) library(nortest) ad.test(ee) ## ## Anderson-Darling normality test ## ## data: ee ## A = 65.039, p-value &lt; 2.2e-16 lillie.test(ee) ## ## Lilliefors (Kolmogorov-Smirnov) normality test ## ## data: ee ## D = 0.059519, p-value &lt; 2.2e-16 boxplot(bd$ylab) #La normalidad de los errores plot(density(ee)) curve(dnorm(x,mean(ee),sd(ee)),add=T,col=&quot;red&quot;) #limitar los datos hasta el percentil punto&lt;-c(0.01,0.90) puntonl&lt;-c(0.99) z&lt;-quantile(bd$ylab,punto,na.rm=T) znl&lt;-quantile(bd$ynolab,puntonl,na.rm=T) znl ## 99% ## 3461.9 bd2&lt;-bd %&gt;% filter((ylab&lt;z[2] &amp; ylab&gt;z[1])) boxplot(bd2$ynolab) #definiendo el modelo sin atípicos model1&lt;-lm(log(ylab)~s02a_03+aestudio+tothrs+s02a_02+area,data=bd2) summary(model1) ## ## Call: ## lm(formula = log(ylab) ~ s02a_03 + aestudio + tothrs + s02a_02 + ## area, data = bd2) ## ## Residuals: ## Min 1Q Median 3Q Max ## -3.4881 -0.3274 0.0722 0.4224 2.0370 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 7.5113154 0.0441424 170.16 &lt;2e-16 *** ## s02a_03 -0.0086739 0.0005627 -15.41 &lt;2e-16 *** ## aestudio 0.0419903 0.0016978 24.73 &lt;2e-16 *** ## tothrs 0.0068773 0.0004245 16.20 &lt;2e-16 *** ## s02a_022.Mujer -0.2978155 0.0173519 -17.16 &lt;2e-16 *** ## areaRural -0.6337193 0.0181983 -34.82 &lt;2e-16 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.6661 on 8258 degrees of freedom ## (4 observations deleted due to missingness) ## Multiple R-squared: 0.3606, Adjusted R-squared: 0.3602 ## F-statistic: 931.4 on 5 and 8258 DF, p-value: &lt; 2.2e-16 boxplot(bd2$ylab) ee1&lt;-residuals(model1) ad.test(ee1) ## ## Anderson-Darling normality test ## ## data: ee1 ## A = 69.102, p-value &lt; 2.2e-16 lillie.test(ee1) ## ## Lilliefors (Kolmogorov-Smirnov) normality test ## ## data: ee1 ## D = 0.06552, p-value &lt; 2.2e-16 ks.test(ee1,&quot;pnorm&quot;,mean(ee1),sd(ee1))#kolmogorov Smirnofv ## Warning in ks.test(ee1, &quot;pnorm&quot;, mean(ee1), sd(ee1)): ties ## should not be present for the Kolmogorov-Smirnov test ## ## One-sample Kolmogorov-Smirnov test ## ## data: ee1 ## D = 0.06552, p-value &lt; 2.2e-16 ## alternative hypothesis: two-sided plot(density(ee1)) curve(dnorm(x,mean(ee1),sd(ee1)),add=T,col=&quot;red&quot;) plot(model1) # Distancia de Cook plot(cooks.distance(model1)) cc&lt;-cooks.distance(model1) bd3&lt;-bd2[cc&lt;quantile(cc,0.90),] model3&lt;-lm(log(ylab)~s02a_03+aestudio+s02a_02+area,data=bd3) summary(model3) ## ## Call: ## lm(formula = log(ylab) ~ s02a_03 + aestudio + s02a_02 + area, ## data = bd3) ## ## Residuals: ## Min 1Q Median 3Q Max ## -3.7477 -0.3023 0.0589 0.3789 2.0127 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 7.8707909 0.0330637 238.05 &lt;2e-16 *** ## s02a_03 -0.0068727 0.0005262 -13.06 &lt;2e-16 *** ## aestudio 0.0357484 0.0015616 22.89 &lt;2e-16 *** ## s02a_022.Mujer -0.3371617 0.0158950 -21.21 &lt;2e-16 *** ## areaRural -0.6177162 0.0177800 -34.74 &lt;2e-16 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.5838 on 7434 degrees of freedom ## (2 observations deleted due to missingness) ## Multiple R-squared: 0.3371, Adjusted R-squared: 0.3367 ## F-statistic: 944.9 on 4 and 7434 DF, p-value: &lt; 2.2e-16 ad.test(residuals(model3)) ## ## Anderson-Darling normality test ## ## data: residuals(model3) ## A = 54.631, p-value &lt; 2.2e-16 lillie.test(residuals(model3)) ## ## Lilliefors (Kolmogorov-Smirnov) normality test ## ## data: residuals(model3) ## D = 0.060717, p-value &lt; 2.2e-16 plot(density(residuals(model3))) curve(dnorm(x,mean(residuals(model3)),sd(residuals(model3))),add=T,col=&quot;red&quot;) plot(model3) plot(cooks.distance(model3)) #ajustando polinomios bd3&lt;-na.omit(bd3) model4&lt;-lm(log(ylab)~poly(s02a_03,2)+poly(aestudio,3)+s02a_02+area,data=bd3) summary(model4) ## ## Call: ## lm(formula = log(ylab) ~ poly(s02a_03, 2) + poly(aestudio, 3) + ## s02a_02 + area, data = bd3) ## ## Residuals: ## Min 1Q Median 3Q Max ## -3.5388 -0.2755 0.0567 0.3658 1.9760 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 7.916703 0.008679 912.136 &lt; 2e-16 ## poly(s02a_03, 2)1 -9.314807 0.629916 -14.787 &lt; 2e-16 ## poly(s02a_03, 2)2 -10.230085 0.579114 -17.665 &lt; 2e-16 ## poly(aestudio, 3)1 14.037367 0.650863 21.567 &lt; 2e-16 ## poly(aestudio, 3)2 1.956320 0.593357 3.297 0.000982 ## poly(aestudio, 3)3 4.658527 0.575849 8.090 6.92e-16 ## s02a_022.Mujer -0.341106 0.015643 -21.806 &lt; 2e-16 ## areaRural -0.602950 0.017392 -34.669 &lt; 2e-16 ## ## (Intercept) *** ## poly(s02a_03, 2)1 *** ## poly(s02a_03, 2)2 *** ## poly(aestudio, 3)1 *** ## poly(aestudio, 3)2 *** ## poly(aestudio, 3)3 *** ## s02a_022.Mujer *** ## areaRural *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.5674 on 7429 degrees of freedom ## Multiple R-squared: 0.3743, Adjusted R-squared: 0.3737 ## F-statistic: 634.9 on 7 and 7429 DF, p-value: &lt; 2.2e-16 ad.test(residuals(model4)) ## ## Anderson-Darling normality test ## ## data: residuals(model4) ## A = 61.647, p-value &lt; 2.2e-16 ## interacciones entre variables model5&lt;-lm(log(ylab)~poly(s02a_03,2)+poly(aestudio,3)+s02a_02+area+s02a_02:aestudio+area:aestudio+exp(aestudio)+I(aestudio^4),data=bd3) summary(model5) ## ## Call: ## lm(formula = log(ylab) ~ poly(s02a_03, 2) + poly(aestudio, 3) + ## s02a_02 + area + s02a_02:aestudio + area:aestudio + exp(aestudio) + ## I(aestudio^4), data = bd3) ## ## Residuals: ## Min 1Q Median 3Q Max ## -3.4917 -0.2675 0.0620 0.3561 2.1623 ## ## Coefficients: (1 not defined because of singularities) ## Estimate Std. Error t value ## (Intercept) 7.366e+00 3.153e-01 23.361 ## poly(s02a_03, 2)1 -8.867e+00 6.240e-01 -14.209 ## poly(s02a_03, 2)2 -9.962e+00 5.745e-01 -17.342 ## poly(aestudio, 3)1 -5.285e+01 2.869e+01 -1.842 ## poly(aestudio, 3)2 -3.606e+01 1.708e+01 -2.112 ## poly(aestudio, 3)3 -8.803e+00 5.156e+00 -1.707 ## s02a_022.Mujer -5.360e-01 3.222e-02 -16.637 ## areaRural -9.519e-01 3.318e-02 -28.689 ## exp(aestudio) -3.246e-10 1.248e-10 -2.601 ## I(aestudio^4) 3.334e-05 1.394e-05 2.391 ## s02a_021.Hombre:aestudio -1.903e-02 2.964e-03 -6.420 ## s02a_022.Mujer:aestudio NA NA NA ## areaRural:aestudio 4.476e-02 3.761e-03 11.903 ## Pr(&gt;|t|) ## (Intercept) &lt; 2e-16 *** ## poly(s02a_03, 2)1 &lt; 2e-16 *** ## poly(s02a_03, 2)2 &lt; 2e-16 *** ## poly(aestudio, 3)1 0.06552 . ## poly(aestudio, 3)2 0.03475 * ## poly(aestudio, 3)3 0.08778 . ## s02a_022.Mujer &lt; 2e-16 *** ## areaRural &lt; 2e-16 *** ## exp(aestudio) 0.00931 ** ## I(aestudio^4) 0.01681 * ## s02a_021.Hombre:aestudio 1.45e-10 *** ## s02a_022.Mujer:aestudio NA ## areaRural:aestudio &lt; 2e-16 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.5609 on 7425 degrees of freedom ## Multiple R-squared: 0.3888, Adjusted R-squared: 0.3879 ## F-statistic: 429.4 on 11 and 7425 DF, p-value: &lt; 2.2e-16 ad.test(residuals(model5)) ## ## Anderson-Darling normality test ## ## data: residuals(model5) ## A = 72.471, p-value &lt; 2.2e-16 #trabajando sobre los valores atípicos desde R library(MASS) ## ## Attaching package: &#39;MASS&#39; ## The following object is masked from &#39;package:dplyr&#39;: ## ## select modela&lt;-rlm(ylab~s02a_02+s02a_03+area,data=bd2) modelb&lt;-lm(ylab~s02a_02+s02a_03+area,data=bd2) summary(modela) ## ## Call: rlm(formula = ylab ~ s02a_02 + s02a_03 + area, data = bd2) ## Residuals: ## Min 1Q Median 3Q Max ## -3304.6 -877.6 -132.7 886.6 4971.1 ## ## Coefficients: ## Value Std. Error t value ## (Intercept) 3801.9182 46.8441 81.1611 ## s02a_022.Mujer -753.3883 33.3455 -22.5934 ## s02a_03 -17.2477 1.0257 -16.8163 ## areaRural -1248.6004 33.5989 -37.1619 ## ## Residual standard error: 1306 on 8264 degrees of freedom summary(modelb) ## ## Call: ## lm(formula = ylab ~ s02a_02 + s02a_03 + area, data = bd2) ## ## Residuals: ## Min 1Q Median 3Q Max ## -3318.5 -948.6 -200.9 829.6 4795.8 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 3796.300 45.878 82.75 &lt;2e-16 *** ## s02a_022.Mujer -695.331 32.658 -21.29 &lt;2e-16 *** ## s02a_03 -16.435 1.004 -16.36 &lt;2e-16 *** ## areaRural -1167.972 32.906 -35.49 &lt;2e-16 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 1276 on 8264 degrees of freedom ## Multiple R-squared: 0.2108, Adjusted R-squared: 0.2106 ## F-statistic: 736 on 3 and 8264 DF, p-value: &lt; 2.2e-16 ad.test(residuals(model)) ## ## Anderson-Darling normality test ## ## data: residuals(model) ## A = 65.039, p-value &lt; 2.2e-16 # Colinealidad (X1=f(X2) library(car) ## Loading required package: carData ## ## Attaching package: &#39;car&#39; ## The following object is masked from &#39;package:dplyr&#39;: ## ## recode vif(model3) ## s02a_03 aestudio s02a_02 area ## 1.160343 1.288865 1.023119 1.147169 sqrt(vif(model3))&gt;2 ##Variance Inflation Factors ## s02a_03 aestudio s02a_02 area ## FALSE FALSE FALSE FALSE # Verificar si la varianza es constante (homocedástico) o no (heterocedástico) library(lmtest) ## Loading required package: zoo ## ## Attaching package: &#39;zoo&#39; ## The following objects are masked from &#39;package:base&#39;: ## ## as.Date, as.Date.numeric bptest(model3) # H0: Homocedsticidad https://en.wikipedia.org/wiki/Breusch%E2%80%93Pagan_test ## ## studentized Breusch-Pagan test ## ## data: model3 ## BP = 704.77, df = 4, p-value &lt; 2.2e-16 #corrigiendo library(rms) ## Loading required package: SparseM ## ## Attaching package: &#39;SparseM&#39; ## The following object is masked from &#39;package:base&#39;: ## ## backsolve ## ## Attaching package: &#39;rms&#39; ## The following object is masked from &#39;package:lmtest&#39;: ## ## lrtest ## The following objects are masked from &#39;package:car&#39;: ## ## Predict, vif ## The following object is masked from &#39;package:vegan&#39;: ## ## calibrate model1 = ols(ylab~s02a_02+s02a_03+area,data=bd3,x=T,y=T) bptest(model1) ## ## studentized Breusch-Pagan test ## ## data: model1 ## BP = 62.036, df = 2, p-value = 3.38e-14 aux&lt;-robcov(model1) aux ## Linear Regression Model ## ## ols(formula = ylab ~ s02a_02 + s02a_03 + area, data = bd3, x = T, ## y = T) ## ## Model Likelihood Discrimination ## Ratio Test Indexes ## Obs 7437 LR chi2 1705.39 R2 0.205 ## sigma1228.3030 d.f. 3 R2 adj 0.205 ## d.f. 7433 Pr(&gt; chi2) 0.0000 g 686.342 ## ## Residuals ## ## Min 1Q Median 3Q Max ## -3311.9 -913.4 -187.0 792.9 4808.2 ## ## ## Coef S.E. t Pr(&gt;|t|) ## Intercept 3732.8060 44.3194 84.23 &lt;0.0001 ## s02a_02=2.Mujer -722.8767 33.8716 -21.34 &lt;0.0001 ## s02a_03 -14.0673 1.0210 -13.78 &lt;0.0001 ## area=Rural -1212.4898 35.9942 -33.69 &lt;0.0001 ## # H0: Homocedasticidad, implica que los EE de B no son los correctos 4.1.6 Paso 6: Predicir a partir del modelo test&lt;-bd3 yest&lt;-predict(model3,test) plot(log(bd3$ylab),yest) plot(bd3$ylab,exp(yest)) 4.2 Probit y Logit Estrategia, llevar valores binarios a valores continuos. Mediante una función de enlace (\\(F(Y)\\)). \\[F(Y)=Y&#39;=X \\beta +\\epsilon\\] Probit: \\[Y=\\Phi (X \\beta +\\epsilon)\\] \\[\\phi^{-1}(Y)=X \\beta +\\epsilon\\] \\[Y&#39;=X \\beta +\\epsilon\\] El enlace \\(F(Y)=\\Phi^{-1}(Y)\\), es conocida como probit. Logit: \\[logit(Y)=log(\\frac{Y}{1-Y})=X\\beta+\\epsilon\\] \\[Y=\\frac{e^{X\\beta+\\epsilon}}{1+e^{X\\beta+\\epsilon}}\\] 4.2.1 En R: load(&quot;C:\\\\Users\\\\ALVARO\\\\Documents\\\\GitHub\\\\EST-384\\\\data\\\\eh18.Rdata&quot;) aux&lt;-levels(eh18p$s04a_01a) eh18p&lt;-eh18p %&gt;% mutate(diabetes=(s04a_01a==aux[1] | s04a_01b==aux[1]),corazon=(s04a_01a==aux[4] | s04a_01b==aux[4]),hiper=(s04a_01a==aux[10] | s04a_01b==aux[10])) eh18p$diabetes&lt;-(eh18p$diabetes==T); eh18p$diabetes[is.na(eh18p$diabetes)]&lt;-F eh18p$corazon&lt;-(eh18p$corazon==T); eh18p$corazon[is.na(eh18p$corazon)]&lt;-F eh18p$hiper&lt;-(eh18p$hiper==T); eh18p$hiper[is.na(eh18p$hiper)]&lt;-F eh18p$cronicas&lt;-(eh18p$diabetes+eh18p$corazon+eh18p$hiper) #modelo para las enfermedades crónicas eh18p$cronicas&lt;-(eh18p$cronicas!=0) logit&lt;-glm(cronicas*1~s02a_02+s02a_03,data=eh18p,family = binomial(link=&quot;logit&quot;)) probit&lt;-glm(cronicas*1~s02a_02+s02a_03,data=eh18p,family = binomial(link=&quot;probit&quot;)) lineal&lt;-lm(cronicas*1~s02a_02+s02a_03,data=eh18p) summary(logit) ## ## Call: ## glm(formula = cronicas * 1 ~ s02a_02 + s02a_03, family = binomial(link = &quot;logit&quot;), ## data = eh18p) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -1.2158 -0.2857 -0.1788 -0.1215 3.3372 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -5.564577 0.079827 -69.708 &lt; 2e-16 *** ## s02a_022.Mujer 0.215954 0.054636 3.953 7.73e-05 *** ## s02a_03 0.055494 0.001305 42.528 &lt; 2e-16 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 12932 on 37516 degrees of freedom ## Residual deviance: 10772 on 37514 degrees of freedom ## AIC: 10778 ## ## Number of Fisher Scoring iterations: 7 summary(probit) ## ## Call: ## glm(formula = cronicas * 1 ~ s02a_02 + s02a_03, family = binomial(link = &quot;probit&quot;), ## data = eh18p) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -1.0746 -0.2981 -0.1727 -0.1043 3.5050 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -2.8553967 0.0353000 -80.890 &lt; 2e-16 *** ## s02a_022.Mujer 0.0951194 0.0261370 3.639 0.000273 *** ## s02a_03 0.0265904 0.0006253 42.525 &lt; 2e-16 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 12932 on 37516 degrees of freedom ## Residual deviance: 10728 on 37514 degrees of freedom ## AIC: 10734 ## ## Number of Fisher Scoring iterations: 7 #score probabilidades lres&lt;-predict(logit,eh18p,type=&quot;response&quot;) pres&lt;-predict(probit,eh18p,type=&quot;response&quot;) plot(density(lres)) points(density(pres),type = &quot;l&quot;,col=&quot;red&quot;) #efectos marginales library(mfx) ## Loading required package: sandwich ## Loading required package: betareg probitmfx(cronicas*1~s02a_02+s02a_03,data=eh18p) ## Call: ## probitmfx(formula = cronicas * 1 ~ s02a_02 + s02a_03, data = eh18p) ## ## Marginal Effects: ## dF/dx Std. Err. z P&gt;|z| ## s02a_022.Mujer 4.9289e-03 1.3552e-03 3.6371 0.0002758 *** ## s02a_03 1.3787e-03 3.6387e-05 37.8892 &lt; 2.2e-16 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## dF/dx is for discrete change for the following variables: ## ## [1] &quot;s02a_022.Mujer&quot; logitmfx(cronicas*1~s02a_02+s02a_03,data=eh18p) ## Call: ## logitmfx(formula = cronicas * 1 ~ s02a_02 + s02a_03, data = eh18p) ## ## Marginal Effects: ## dF/dx Std. Err. z P&gt;|z| ## s02a_022.Mujer 0.00456597 0.00115874 3.9405 8.132e-05 *** ## s02a_03 0.00117352 0.00003123 37.5766 &lt; 2.2e-16 *** ## --- ## Signif. codes: ## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## dF/dx is for discrete change for the following variables: ## ## [1] &quot;s02a_022.Mujer&quot; #ajuste library(DescTools) ## ## Attaching package: &#39;DescTools&#39; ## The following object is masked from &#39;package:car&#39;: ## ## Recode ## The following objects are masked from &#39;package:Hmisc&#39;: ## ## %nin%, Label, Mean, Quantile PseudoR2(logit) ## McFadden ## 0.167065 PseudoR2(probit) ## McFadden ## 0.170421 #comparando library(memisc) ## ## Attaching package: &#39;memisc&#39; ## The following objects are masked from &#39;package:DescTools&#39;: ## ## %nin%, Cor, Cov, Mean, Median, Range, Var ## The following object is masked from &#39;package:car&#39;: ## ## recode ## The following objects are masked from &#39;package:Hmisc&#39;: ## ## %nin%, html, Mean ## The following object is masked from &#39;package:ggplot2&#39;: ## ## syms ## The following objects are masked from &#39;package:dplyr&#39;: ## ## collect, recode, rename, syms ## The following object is masked from &#39;package:lubridate&#39;: ## ## is.interval ## The following objects are masked from &#39;package:stats&#39;: ## ## contr.sum, contr.treatment, contrasts ## The following object is masked from &#39;package:base&#39;: ## ## as.array mtable(logit,probit) ## ## Calls: ## logit: glm(formula = cronicas * 1 ~ s02a_02 + s02a_03, family = binomial(link = &quot;logit&quot;), ## data = eh18p) ## probit: glm(formula = cronicas * 1 ~ s02a_02 + s02a_03, family = binomial(link = &quot;probit&quot;), ## data = eh18p) ## ## ========================================================= ## logit probit ## --------------------------------------------------------- ## (Intercept) -5.565*** -2.855*** ## (0.080) (0.035) ## s02a_02: 2.Mujer/1.Hombre 0.216*** 0.095*** ## (0.055) (0.026) ## s02a_03 0.055*** 0.027*** ## (0.001) (0.001) ## --------------------------------------------------------- ## Log-likelihood -5385.838 -5364.138 ## N 37517 37517 ## ========================================================= ## Significance: *** = p &lt; 0.001; ** = p &lt; 0.01; ## * = p &lt; 0.05 "],
["clasificación.html", "5 Clasificación 5.1 Arboles de decision 5.2 Naive Bayes", " 5 Clasificación 5.1 Arboles de decision 5.2 Naive Bayes "],
["minería-de-texto.html", "6 Minería de Texto 6.1 Recolección de texto 6.2 Nubes de palabras 6.3 Análisis de sentimiento 6.4 n-gramas y correlaciones", " 6 Minería de Texto 6.1 Recolección de texto 6.2 Nubes de palabras 6.3 Análisis de sentimiento 6.4 n-gramas y correlaciones "]
]
